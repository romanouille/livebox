define(["engine/sopws"],function(SOPWS){"use strict";var fields,getSopVersion=function(){var response;response=SOPWS.invokeSopStbApi({service:"com.softathome.System.Software",method:"GetSopVersion",parameters:{}});if(response&&response.data){console.debug("CallStack: com.softathome.System.Software.GetSopVersion is "+JSON.stringify(response.data));if(response.data.result.indexOf(",")>=0){return response.data.result.split(",")[1]}return response.data.result}console.error("CallStack: Failed to retrieve SOP STB release version (com.softathome.System.Software.GetSopVersion)");return""},getHardwareVersion=function(){var response;response=SOPWS.invokeSopStbApi({service:"com.softathome.System.Hardware",method:"GetProductId",parameters:{}});if(response&&response.data){console.debug("CallStack: com.softathome.System.Hardware.GetProductId is "+JSON.stringify(response.data));if(response.data.result.indexOf(",")>=0){return response.data.result.split(",")[1].replace(/"/g,"")}return response.data.result.replace(/"/g,"")}console.error("CallStack: Failed to retrieve SOP STB product identifier (com.softathome.System.Hardware.GetProductId)");return""},getDriverVersion=function(){var response;response=SOPWS.invokeSopStbApi({service:"com.softathome.System.Hardware",method:"GetDriverVersion",parameters:{}});if(response&&response.data){console.debug("CallStack: com.softathome.System.Hardware.GetDriverVersion is "+JSON.stringify(response.data));if(response.data.result.indexOf(",")>=0){return response.data.result.split(",")[1].replace(/"/g,"")}return response.data.result.replace(/"/g,"")}console.error("CallStack: Failed to retrieve SOP STB driver version (com.softathome.System.Hardware.GetDriverVersion)");return""},getDeviceInfo=function(){var response,param;response=SOPWS.invokeSopStbApi({service:"DeviceInfo",method:"get",parameters:{}});if(response&&response.status){console.debug("CallStack: DeviceInfo is "+JSON.stringify(response.status));fields.hgwDeviceInfo={ModelName:"Sagemcom_SG_LB3_1.1.0"};for(param in response.status){if(response.status.hasOwnProperty(param)){fields.hgwDeviceInfo[param]=response.status[param]}}}else{fields.hgwDeviceInfo={};fields.hgwDeviceInfo.ModelName="Sagemcom_SG_LB3_1.1.0"}};fields={hgwDeviceInfo:null};return{init:function(isOnHgw,useSimulationMode){var undef,date,result;if(isOnHgw===undef){isOnHgw=false}date=new Date;if(isOnHgw){if(useSimulationMode){result={sop:"7.0",hardware:"Siligence_3.1.0",driver:"1.0",currDate:date}}else{getDeviceInfo();result={sop:"0",hardware:fields.hgwDeviceInfo.ModelName,driver:"0",currDate:date}}}else{if(useSimulationMode){result={sop:"7.0",hardware:"EMULATOR",driver:"1.0",currDate:date}}else{result={sop:getSopVersion(),hardware:getHardwareVersion(),driver:getDriverVersion(),currDate:date}}}return result}}});