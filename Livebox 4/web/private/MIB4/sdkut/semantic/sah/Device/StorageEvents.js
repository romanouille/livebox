define(["utils/console"],function(console){"use strict";return{handleEvent:function(aHandler,aReason,aAttributes){var newEvent;console.debug("StorageEvents: Processing event "+aHandler+"-"+aReason+(aAttributes?" with attributes "+JSON.stringify(aAttributes):""));newEvent={id:"sah.Device.StorageEvents",data:{reason:aReason,handler:aHandler,error:null}};if(aAttributes.device_id){newEvent.data.deviceId=aAttributes.device_id}if(aAttributes.volume_id){newEvent.data.volumeId=aAttributes.volume_id}if(aHandler==="STORAGE"){if(aReason==="DEVICE_FORMATTING"){newEvent.data.operationStatus=aAttributes.format_status;newEvent.data.operationProgress=aAttributes.format_progress}else if(aReason==="VOLUME_CONNECTED"){newEvent.data.connecting=true}else if(aReason==="VOLUME_DISCONNECTED"){newEvent.data.connecting=false}else if(aReason==="VOLUME_MOUNTING"){newEvent.data.operationStatus=aAttributes.mount_status}else if(aReason==="VOLUME_UNMOUNTING"){newEvent.data.operationStatus=aAttributes.unmount_status}else if(aReason!=="QUOTA_ALMOST_REACHED"&&aReason!=="VOLUME_FORMATTING"){newEvent.error="StorageEvents: Unexpected event '"+aHandler+"/"+aReason+"'"}}return newEvent}}});