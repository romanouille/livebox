define(["utils/console","engine/callStack"],function(console,callStack){"use strict";return{getRespondToPingState:{name:"Returns the permission to respond to ping requests",description:"This method returns the permission to respond to ping requests",fields:{uuid:null,nbStep:0,mxStep:0,status:0,data:{},initialParameters:{}},call:function(aStep,aResult){var result;if(aStep==="0"){this.fields.uuid=aResult.uuid;this.fields.status=0;this.fields.nbStep=0;this.fields.mxStep=0;this.fields.mxStep+=1;callStack.push("api","pcb.Firewall.getRespondToPing","1",this,{sourceInterface:"data"})}else{if(aStep==="1"){this.fields.nbStep+=1;if(aResult.status===0||aResult.status===true){this.fields.data={isEnabledIPv4:aResult.data.enableIPv4,isEnabledIPv6:aResult.data.enableIPv6}}else{this.fields.mxStep=-1;this.fields.status=-1;callStack.logMessage("SEM_SYN_ERROR")}}else{console.warn("Unexpected step '"+aStep+"' in call stack");this.fields.nbStep-=1}}if(this.fields.nbStep>=this.fields.mxStep){result={status:this.fields.status};if(this.fields.status===0&&this.fields.data){result.data=this.fields.data}callStack.popAll("api",result,this.fields.uuid)}}},setRespondToPingState:{name:"Enable/Disable the response to ping requests",description:"This method sets parmission to response to ping requests",fields:{uuid:null,nbStep:0,mxStep:0,status:0,data:{},initialParameters:{}},call:function(aStep,aResult){var result;if(aStep==="0"){this.fields.uuid=aResult.uuid;this.fields.status=0;this.fields.nbStep=0;this.fields.mxStep=0;this.fields.initialParameters=aResult.inputList[0];this.fields.mxStep+=1;callStack.push("api","pcb.Firewall.setRespondToPing","1",this,{sourceInterface:"data",service_enable:{enableIPv4:this.fields.initialParameters.isEnabledIPv4,enableIPv6:this.fields.initialParameters.isEnabledIPv6}})}else{if(aStep==="1"){this.fields.nbStep+=1;if(aResult.status!==0&&aResult.status!==true){this.fields.mxStep=-1;this.fields.status=-1;callStack.logMessage("SEM_SYN_ERROR")}}else{console.warn("Unexpected step '"+aStep+"' in call stack");this.fields.nbStep-=1}}if(this.fields.nbStep>=this.fields.mxStep){result={status:this.fields.status};if(this.fields.status===0&&this.fields.data){result.data=this.fields.data}callStack.popAll("api",result,this.fields.uuid)}}}}});