define(["utils/console","engine/callStack"],function(console,callStack){"use strict";return{listLevels:{name:"Retrieves the list of supported firewall levels",description:"This method lists the firewall levels that are supported.",fields:{uuid:null,nbStep:0,mxStep:0,status:0,data:{}},call:function(aStep,aResult){var result;if(aStep==="0"){this.fields.uuid=aResult.uuid;this.fields.status=0;this.fields.data.levelList=["Low","Medium","High","Custom"];this.fields.nbStep=0;this.fields.mxStep=0}if(this.fields.nbStep>=this.fields.mxStep){result={status:this.fields.status};if(this.fields.status===0&&this.fields.data){result.data=this.fields.data}callStack.popAll("api",result,this.fields.uuid)}}},getLevel:{name:"Retrieves the current firewall level",description:"This method returns the current firewall level.",fields:{uuid:null,nbStep:0,mxStep:0,status:0,data:{},inputArg:null},call:function(aStep,aResult){var result;if(aStep==="0"){this.fields.uuid=aResult.uuid;this.fields.inputArg=aResult.inputList[0];this.fields.status=0;this.fields.data={level:"",levelIPv6:""};this.fields.nbStep=0;this.fields.mxStep=0;if(!this.fields.inputArg||typeof this.fields.inputArg.ipVersion==="string"&&(this.fields.inputArg.ipVersion==="4"||this.fields.inputArg.ipVersion==="0")){this.fields.mxStep+=1;callStack.push("api","pcb.Firewall.getFirewallLevel","1",this,{})}else{this.fields.mxStep+=1;callStack.reCall(this,"1",0)}}else{this.fields.nbStep+=1;switch(aStep){case"1":if(aResult){if(aResult.status===0||aResult.status===true){this.fields.data.level=aResult.data}else{this.fields.mxStep=0;this.fields.status=-1;callStack.logMessage("SEM_SYN_ERROR");break}}if(this.fields.inputArg&&typeof this.fields.inputArg.ipVersion==="string"&&(this.fields.inputArg.ipVersion==="6"||this.fields.inputArg.ipVersion==="0")){this.fields.mxStep+=1;callStack.push("api","pcb.Firewall.getFirewallIPv6Level","2",this,{})}break;case"2":if(aResult.status===0||aResult.status===true){this.fields.data.levelIPv6=aResult.data}else{this.fields.mxStep=0;this.fields.status=-1;callStack.logMessage("SEM_SYN_ERROR")}break;default:console.warn("Unexpected step '"+aStep+"' in call stack");this.fields.nbStep-=1;break}if(this.fields.nbStep>=this.fields.mxStep){result={status:this.fields.status};if(this.fields.status===0&&this.fields.data){result.data=this.fields.data}callStack.popAll("api",result,this.fields.uuid)}}}},setLevel:{name:"Updates the current firewall level",description:"This method sets the current firewall level.",fields:{uuid:null,nbStep:0,mxStep:0,status:0,data:{}},call:function(aStep,aResult){var result;if(aStep==="0"){this.fields.nbStep=0;this.fields.mxStep=0;this.fields.status=0;this.fields.uuid=aResult.uuid;this.fields.inputArg=aResult.inputList[0];if(typeof this.fields.inputArg.level==="string"){if(typeof this.fields.inputArg.ipVersion!=="string"||this.fields.inputArg.ipVersion==="4"||this.fields.inputArg.ipVersion==="0"){this.fields.mxStep+=1;callStack.push("api","pcb.Firewall.setFirewallLevel","1",this,{level:this.fields.inputArg.level})}else{this.fields.mxStep+=1;callStack.reCall(this,"1",0)}}}else{this.fields.nbStep+=1;switch(aStep){case"1":if(aResult){if(aResult.status===0||aResult.status===true){this.fields.data=aResult.data}else{this.fields.mxStep=0;this.fields.status=-1;callStack.logMessage("SEM_SYN_ERROR");break}}if(typeof this.fields.inputArg.ipVersion==="string"&&(this.fields.inputArg.ipVersion==="6"||this.fields.inputArg.ipVersion==="0")){this.fields.mxStep+=1;callStack.push("api","pcb.Firewall.setFirewallIPv6Level","2",this,{level:this.fields.inputArg.level})}break;case"2":if(aResult.status===0||aResult.status===true){this.fields.data=aResult.data}else{this.fields.mxStep=0;this.fields.status=-1;callStack.logMessage("SEM_SYN_ERROR")}break;default:console.warn("Unexpected step '"+aStep+"' in call stack");this.fields.nbStep-=1;break}if(this.fields.nbStep>=this.fields.mxStep){result={status:this.fields.status};callStack.popAll("api",result,this.fields.uuid)}}}}}});