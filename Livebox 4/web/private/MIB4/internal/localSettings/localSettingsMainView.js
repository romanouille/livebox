define(["utils/console","utils/basics","lib/eventHandler","lib/stateViewInterface","jquery","text","templates_app/template","text!bootstrap/bootstrap.css","json!app/config/localSettingsMain.json","app/localSettingsSharedView"],function(console,basicUtilities,EventHandlerClass,StateViewClass,$,Text,TemplateClass,Bootstrap,Config,SharedViewClass){"use strict";function LocalSettingsMainViewClass(aStateId,aTranslateObj){this.fields={currentData:{}};StateViewClass.call(this,aStateId,aTranslateObj);this.init=function(aCallback){console.debug("LocalSettingsMainViewClass: Initialising state '"+this.getId()+"'");basicUtilities.queue([function(aNext){SharedViewClass.import(aNext,this)},function(aNext,aResult){if(!aResult||aResult.status===0){this.setStyle(aNext)}else{basicUtilities.callback(aCallback,false,-1,null);this.notifyError("LocalSettingsMainViewClass: Failed to import shared view class","aba0xxx")}},function(aNext,aResult){if(!aResult||aResult.status===0){basicUtilities.callback(aCallback,false,0,null)}else{basicUtilities.callback(aCallback,false,-1,null);this.notifyError("LocalSettingsMainViewClass: Failed to set style","aba0xxx")}}],this)};this.quit=function(aCallback){console.debug("LocalSettingsMainViewClass: Releasing state '"+this.getId()+"'");$("#cancel").click();basicUtilities.callback(aCallback,false,0,null)};this.enable=function(aCallback){console.debug("LocalSettingsMainViewClass: Enabling state '"+this.getId()+"'");basicUtilities.queue([function(aNext){this.setAppCloseButton(null,"cancel");this.setAppCloseButton(aNext,"app_close")},function(aNext,aResult){if(!aResult||aResult.status===0){this.viewDisplayPage(aNext)}else{basicUtilities.callback(aCallback,false,-1,null);this.notifyError("LocalSettingsMainViewClass: Failed to set app close button","aba0157")}},function(aNext,aResult){if(!aResult||aResult.status===0){basicUtilities.callback(aCallback,false,0,null)}else{basicUtilities.callback(aCallback,false,-1,null);this.notifyError("LocalSettingsMainViewClass: Failed to display view","aba0158")}}],this)};this.disable=function(aCallback){console.debug("LocalSettingsMainViewClass: Disabling state '"+this.getId()+"'");basicUtilities.callback(aCallback,false,0,null)};this.viewDisplayPage=function(aCallback){basicUtilities.queue([function(aNext){this.fillTemplate(aNext,TemplateClass.template,Config)},function(aNext,aResult){if(!aResult||aResult.status===0){$(window.document.body).html(aResult.data);this.translate();this.setPageTitle(aNext,$(".header-title").find("h1").find("span").html());$("input[name=languageChoice][value="+this.fields.currentData.getLanguage.languageId+"]").prop("checked","true");this.setDisabledInput(aNext,"save",true)}else{basicUtilities.callback(aCallback,false,-1,null);this.notifyError("LocalSettingsMainViewClass: ","abaxxx")}},function(){$("input[name=languageChoice]").change(function(){this.setDisabledInput(null,"save",false)}.bind(this));$("#save").on("click",null,function(){this.fireEvent("ViewSubmitted",{value:$("input[name=languageChoice]:checked").val()})}.bind(this));basicUtilities.callback(aCallback,false,0,null)}],this)}}return LocalSettingsMainViewClass});