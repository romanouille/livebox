define(["utils/console","utils/basics","lib/stateCtrlInterface","app/systemInformationSharedCtrl"],function(console,basicUtilities,StateCtrlClass,sharedCtrlClass){"use strict";function SystemInformationgeneralCtrlClass(aStateId,aStateManager,aSahObj,aViewObj){var fields,globalResult,onViewEvent=function(aEventId,aData){if(aEventId==="ViewUpdated"){console.debug("SystemInformationgeneralCtrlClass: View event '"+aEventId+"' with data "+JSON.stringify(aData))}else if(aEventId==="ViewCancelled"){console.debug("SystemInformationgeneralCtrlClass: View event '"+aEventId+"' with data "+JSON.stringify(aData));this.quit()}else if(aEventId==="ViewSubmitted"){console.debug("SystemInformationgeneralCtrlClass: View event '"+aEventId+"' with data "+JSON.stringify(aData));if(aData.state==="General"){window.location.hash="#General"}else if(aData.state==="DSL"){window.location.hash="#DSL"}else if(aData.state==="FTTH"){window.location.hash="#FTTH"}else if(aData.state==="Internet"){window.location.hash="#Internet"}else if(aData.state==="Wifi"){window.location.hash="#Wifi"}else if(aData.state==="LAN"){window.location.hash="#LAN"}else if(aData.state==="voIP"){window.location.hash="#voIP"}else if(aData.state==="USB"){window.location.hash="#USB"}else if(aData.state==="TV"){window.location.hash="#TV"}}else{console.warn("SystemInformationgeneralCtrlClass: Unexpected event '"+aEventId+"'")}};fields={};globalResult={};StateCtrlClass.call(this,aStateId,aStateManager,aSahObj,aViewObj);this.init=function(aCallback){console.debug("SystemInformationgeneralCtrlClass: Initialising state '"+this.getId()+"'");basicUtilities.queue([function(aNext){this.getViewObj().subscribeEvents(this.getId(),onViewEvent.bind(this));this.getViewObj().init(aNext)},function(aNext,aResult){if(!aResult||aResult.status===0){basicUtilities.callback(aCallback,false,0,null)}else{basicUtilities.callback(aCallback,false,-1,null)}}],this)};this.quit=function(aCallback){console.debug("SystemInformationgeneralCtrlClass: Releasing state '"+this.getId()+"'");basicUtilities.queue([function(aNext){this.getViewObj().quit(aNext)},function(aNext,aResult){if(!aResult||aResult.status===0){basicUtilities.callback(aCallback,false,0,null)}else{basicUtilities.callback(aCallback,false,-1,null)}}],this)};this.enable=function(aCallback){console.debug("SystemInformationgeneralCtrlClass: Enabling state '"+this.getId()+"'");basicUtilities.queue([function(aNext){this.getViewObj().enable(aNext)},function(aNext,aResult){if(!aResult||aResult.status===0){sharedCtrlClass.import(aNext,this)}else{basicUtilities.callback(aCallback,false,-1,null)}},function(aNext,aResult){if(!aResult||aResult.status===0){this.checkCurrentConnection(aNext)}else{basicUtilities.callback(aCallback,false,-1,null)}},function(aNext,aResult){if(!aResult||aResult.status===0){this.getGeneralStatus()}else{basicUtilities.callback(aCallback,false,-1,null)}},function(aNext,aResult){if(!aResult||aResult.status===0){basicUtilities.callback(aCallback,false,0,null)}else{basicUtilities.callback(aCallback,false,-1,null)}}],this)};this.disable=function(aCallback){console.debug("SystemInformationgeneralCtrlClass: Disabling state '"+this.getId()+"'");basicUtilities.queue([function(aNext){this.getViewObj().disable(aNext)},function(aNext,aResult){if(!aResult||aResult.status===0){basicUtilities.callback(aCallback,false,0,null)}else{basicUtilities.callback(aCallback,false,-1,null)}}],this)};this.getGeneralStatus=function(aCallback){basicUtilities.queue([function(aNext){this.callSahApi("sah.Device.Information.getBasicInformation",aNext,null)},function(aNext,aResult){if(!aResult||aResult.status===0){globalResult.basicInformation=aResult.data;this.callSahApi("sah.Connection.Client.getCurrentConfiguration",aNext,null)}else{this.getViewObj().notifyError("SystemInformationgeneralCtrlClass: failed to get device informations","yke0001");basicUtilities.callback(aNext,false,0,null)}},function(aNext,aResult){if(!aResult||aResult.status===0){globalResult.currentConfiguration=aResult.data;this.callSahApi("sah.Connection.Client.getStatistics",aNext,null)}else{this.getViewObj().notifyError("SystemInformationgeneralCtrlClass: failed to get current configuration","yke0002");basicUtilities.callback(aNext,false,0,null)}},function(aNext,aResult){if(!aResult||aResult.status===0){globalResult.statistics=aResult.data;this.callSahApi("sah.Connection.Client.getConnectionState",aNext,null)}else{this.getViewObj().notifyError("SystemInformationgeneralCtrlClass: failed to get wan statistics","yke0003");basicUtilities.callback(aNext,false,0,null)}},function(aNext,aResult){if(!aResult||aResult.status===0){globalResult.connectionState=aResult.data;this.callSahApi("sah.Installation.Configuration.getCountry",aNext,null)}else{this.getViewObj().notifyError("SystemInformationgeneralCtrlClass: failed to get connection state","yke0004");basicUtilities.callback(aNext,false,0,null)}},function(aNext,aResult){if(!aResult||aResult.status===0){globalResult.country=aResult.data;this.callSahApi("sah.Connection.Client.Wan.getStatus",aNext,null)}else{this.getViewObj().notifyError("SystemInformationgeneralCtrlClass: failed to get country configuration","yke0005");basicUtilities.callback(aNext,false,0,null)}},function(aNext,aResult){if(!aResult||aResult.status===0){globalResult.wanStatus=aResult.data;this.callSahApi("sah.Connection.Client.Wan.getStatistics",aNext,null)}else{this.getViewObj().notifyError("SystemInformationgeneralCtrlClass:  failed to get wan status","yke0005");basicUtilities.callback(aNext,false,0,null)}},function(aNext,aResult){if(!aResult||aResult.status===0){globalResult.wanStatistics=aResult.data;basicUtilities.callback(aCallback,false,0,null)}else{this.getViewObj().notifyError("SystemInformationgeneralCtrlClass: failed to get wan statistics","yke0006");basicUtilities.callback(aCallback,false,-1,null)}this.getViewObj().displayGeneralInfo(globalResult)}],this)}}return SystemInformationgeneralCtrlClass});