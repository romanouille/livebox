define(["jquery","jquery-ui","lib/sah-core/sah"],function($){"use strict";$.widget("sah.settings",{options:{slides:[]},_languages:["en","fr"],_create:function(){console.log("app slider: slides = "+this.options.slides);var self=this;var element=this.element.find(".slider");var popup=this.element.find(".sah_popup");var manifest=this.options.manifest;for(var index=0;index<this.options.slides.length;index++){var content=this.options.slides[index];var pattern="{{title}}";if(content.indexOf(pattern)>=0){content=content.replace(pattern,this.options.manifest.option("title"))}var item='<div class="slider-item">'+content+"</div>";console.log("adding slider item"+item);element.append(item)}$(popup).sah_dialog({buttons:[{translate:"common.done",click:function(){popup.sah_dialog("close")}}],actions:{close:false,back:true,favorite:true,remove:false,reload:false},manifest:manifest,index:this.options.index});popup.find(".sah_dialog_body .title").attr("translate",manifest.option("title"));var radios="<div id=langlist>";for(var i=0;i<self._languages.length;i++){var lang=self._languages[i];radios+='<input type="radio" id="lang'+i+'" name=langlist lang='+lang+">"+'<label for="lang'+i+'" translate=sah_language.'+lang+"></label>"}radios+="</div>";radios=$(radios).buttonset().change(function(e){var lang=$(e.target).attr("lang");if(SAH.currentTranslator().currentLanguage()!=lang){self.element.find(".currlang").attr("translate","sah_language."+lang);SAH.loadLanguage(lang);$.when(SAH.currentTranslator().isLoaded()).then(function(){SAH.currentTranslator().run()})}});$(radios).find(".ui-button-text").attr("translate","sah_language."+lang);$(radios).appendTo(popup.find(".sah_dialog_body"));this.element.on("activate",function(){popup.sah_dialog("open")});SAH.currentTranslator().run(this.element);SAH.currentTranslator().run(popup)},start:function(){var self=this;if(this.options.slides.length==0){return}var currlang=SAH.currentTranslator().currentLanguage();var el=this.element.find(".currlang");if(el.attr("translate")!="sah_language."+currlang){el.attr("translate","sah_language."+currlang);SAH.currentTranslator().run(el.parent())}},stop:function(){var element=$(this.element).find(".slider");element.finish()},resize:function(){}})});