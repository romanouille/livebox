console.log("loaded mywifi");$.widget("wm3.mywifi",{options:{manifest:{},index:-1,vaps:[]},_object:{},_create:function(){this._popup=this.element.find(".sah_popup.wifi_onoff");var manifest=this.options.manifest;var index=this.options.index;var vaps=this.options.vaps;var width=this.element.width();var tile=this.element;var popup=this._popup;this._object=new SAH.Object;$(popup).sah_dialog({buttons:[{translate:"common.enter",click:function(){SAH.WM.launchApp(manifest);popup.sah_dialog("close")}}],defaultButton:0,actions:{close:false,back:true,favorite:true,remove:true,reload:true},manifest:manifest,index:index});this.element.find(".title").translate(manifest.option("applet.name",index));popup.find(".sah_dialog_body .title").translate(manifest.option("applet.name",index));$.each(vaps,function(index,value){var switch_button='<label class="textCenter" for="'+value.key+'">'+value.label+"</label>"+'<div class="sah_ui_switch">'+'    <input type="checkbox" name="'+value.key+'">'+"</div>";$(switch_button).appendTo(popup.find(".sah_dialog_body"));popup.find(':checkbox[name="'+value.key+'"]').data("vap",value);var status='<div name="'+value.key+'">'+'  <span class="label black">'+value.label+"</span>"+'  <span class="value sah_green_dark">?</span>'+"</div>";$(status).appendTo(tile.find(".status"))});$(popup).find(":checkbox").switchButton({width:width/2,button_width:width/4,height:25});tile.on("activate",function(){popup.sah_dialog("open")})},_eventhandler:function(event){var vaps=this.options.vaps;var _this=this},start:function(){var manifest=this.options.manifest;var vaps=this.options.vaps;var popup=this._popup;var _this=this;var update=function(vap){$.when(_this._object.invoke(vap.object,"isUp")).then(function(status){var text=status==true?"on":"off";_this.element.find('.status div[name="'+vap.key+'"] .value').translate("common."+text);popup.find(':checkbox[name="'+vap.key+'"]').prop("checked",status).switchButton("setChecked",status).change(function(){var params={mibs:{penable:{}}};params.mibs.penable[vap.key]={PersistentEnable:$(this).is(":checked"),Enable:$(this).is(":checked")};_this._object.invoke(vap.object,"setWLANConfig",params)})});_this._object.subscribe(vap.object,"changed",function(event){$.each(event.object.attributes,function(key,value){if(key=="VAPStatus"){switch(value){case"Up":_this.element.find('.status div[name="'+vap.key+'"] .value').html("ON");break;case"Down":_this.element.find('.status div[name="'+vap.key+'"] .value').html("OFF");break}}})})};$.each(vaps,function(index,value){update(value)})},stop:function(){var _this=this;this._popup.find(":checkbox").off();_this._object.unsubscribe()},resize:function(){}});