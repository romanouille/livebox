/*!
 * Copyright : (C) 2008,2009 SAGEM Communications - URD2
 *
 * This JavaScript file is the property of Sagem Communications
 * and may not be copied or used without prior written consent.
 *
 * vim: set fileencoding=utf-8
 */
(function(b,a){a.uiWidget("guiObjset",{version:"1.0.0",setter:"addItem removeItem reset disable loadValues postValues resetValues subscribeForNotification resetNotifications",getter:"modified isValid newRequest",defaults:a.cnf(b.extend({},b.widget.defaults,{itemClass:"gui-objset",client:a.defaultClient,xpath:"",items:b([])}))},{_init:function(){var c=this.options;this._uiClasses=b[this.namespace][this.widgetName].uiClasses.split(/,?\s+/);a.guiItem.prototype._registerClasses.call(this,true);a.extend.call(c,this.element);this.element.addClass(c.itemClass);this._resetRequest=null},destroy:function(){if(!this.element.data("guiObjset")){return}this.reset();this.element.removeData("guiObjset").unbind(".guiObjset").removeClass(this.options.itemClass);b.widget.prototype.destroy.call(this)},addItem:function(c){var d=this.options;d.items=b(d.items.add(c))},removeItem:function(d){var c=this,e=this.options;if(e.client.isConnected()){if(this._resetRequest===null){this._resetRequest=this.newRequest()}b(d).guiItem("getResetActions",c._resetRequest)}e.items=b(e.items.not(d))},reset:function(){var c=this.options;c.items.guiItem("option","objset",null);this.removeItem(c.items);this.resetNotifications()},newRequest:function(c){var d=this.options;return d.client.newRequest(c)},loadValues:function(c,e,d){if((c!==undefined)&&!b.isFunction(c)){d=c;c=undefined}else{if((e!==undefined)&&!b.isFunction(e)){d=e;e=undefined}}var h=this.options,g=this.newRequest(d),f=b.extend({},d);h.items.guiItem("getLoadActions",g,d);if(g.actions.length){g.send(c,e)}},postValues:function(c,e,d){if(!this.isValid()){return}if((c!==undefined)&&!b.isFunction(c)){d=c;c=undefined}else{if((e!==undefined)&&!b.isFunction(e)){d=e;e=undefined}}var g=this.options,f=this.newRequest(d);g.items.guiItem("getPostActions",f);f.send(c,e)},resetValues:function(){var c=this.options;c.items.guiItem("reset");this.element.change()},subscribeForNotification:function(c){var e=this.options,d=this.newRequest(c);e.items.guiItem("getNotifyActions",d);if(d.actions.length){d.send()}},resetNotifications:function(d,c){var f=this.options;if(!b.isFunction(d)){c=d;d=undefined}if(f.client.isConnected()){var e=this._resetRequest;if((e!==null)&&e.actions.length){e.send()}}this._resetRequest=null},disable:function(c){var d=this.options;d.items.guiItem("option","disabled",c)},modified:function(){var d=this.options,c=false;d.items.each(function(e){var f=b(this).guiItem("modified");if(f){console.info("Modified item: %o",this)}c=f?true:c});return c},isValid:function(){var d=this.options,c=true;d.items.each(function(e){if(!b(this).guiItem("isValid")){c=false}});return c}});a.uiWidget("guiDataObjset",a.guiObjset,{version:"1.0.0",setter:"",getter:"",defaults:a.cnf({client:null,data:{}})},{_init:function(){a.guiObjset.prototype._init.call(this)},destroy:function(){if(!this.element.data("guiDataObjset")){return}this.element.removeData("guiDataObjset").unbind(".guiDataObjset");a.guiObjset.prototype.destroy.call(this)},newRequest:function(c){return new a.api.DataRequest(this.options.data,c)}})}(jQuery,jQuery.gui));(function(b,a){a.uiWidget("guiItem",{version:"1.0.0",setter:"reset showError getLoadActions getPostActions getNotifyActions getResetActions",getter:"isValid xpath",getterSetter:"value current modified",eventPrefix:"gui_",defaults:a.cnf(b.extend({},b.widget.defaults,{connected:true,readOnly:false,writeOnly:false,notify:false,notifTimer:0,autoSubscribe:false,objset:null,xpath:"",capability:null,itemClass:"gui-item",parentItem:"",defValue:"",disabled:false,checked:false,confirmFirst:null,html:null,customHtml:null,htmlReplace:false,text:null,help:"",values:a.array({value:"",isDefault:false,guiValue:a.cnf({value:"",cssClass:""})},[]),description:false,loaded:false,subscribed:false,rpc:false}))},{_init:function(){var d=this.options,c=this;this._extendOptions();this._current=null;this._events=[];if((d.capability!==null)&&(d.capability.constructor!==a.api.Capability)){d.capability=new a.api.Capability(d.capability)}if(d.connected&&!d.xpath){console.warn("guiItem: %o do not have an item xpath",this.element[0]);d.connected=false}this._uiClasses=b[this.namespace][this.widgetName].uiClasses.split(/,?\s+/);this._initHtml();this._registerClasses(true);this.element.addClass(d.itemClass);if(d.help.length){this.element.attr("title",d.help)}if((d.objset===null)&&d.connected){d.objset=this.element.parents(".gui-objset").eq(0)}else{d.objset=b(d.objset)}if(d.objset.length){d.objset.guiObjset("addItem",this.element)}else{d.objset=null;if(d.connected){console.warn("guiItem: %o do not have a valid objset",this.element[0]);d.connected=false}}d.parentItem=b((d.parentItem!=="")?d.parentItem:[]);if(d.customHtml){this.element.append(d.customHtml)}},_extendOptions:function(){a.extend.call(this.options,this.element)},_registerClasses:function(d){var c=this;b.each(this._uiClasses,d?function(e,f){c.element.data(f,c)}:function(e,f){c.element.removeData(f)})},_disabled:function(c){},modified:function(c){var f=this.options;if(f.writeOnly&&this._getValue()===this.options.defValue){return false}if(c===undefined){if(f.readOnly||!(f.loaded||f.writeOnly)){return false}else{if(f.modified!==undefined){return f.modified}else{var e=this.value(),d=f.capability?f.capability.getEnum(this._current):undefined;return(String(e)!==String(this._current))&&(!d||(e!==d.name))}}}else{f.modified=Boolean(c)}},_setData:function(c,d){var e=this.options;b.widget.prototype._setData.call(this,c,d);if(c==="disabled"){this._disabled(d)}else{if(c==="objset"){if(d===null){e.connected=false}}else{if(c==="xpath"){if(!d){e.connected=false}}}}},_initHtml:function(c){var d=this.options,e;c=(c===undefined)?d.html:c;if((c!==null)&&c.length){e=!a.isString(c);if(d.htmlReplace){if(e){c=c.clone()}newElement=b(c);this.element.replaceWith(newElement);this._registerClasses(false);this.element=newElement}else{if(e){c=c.children().clone()}this.element.html(c)}}},_initRPC:function(){var c=this,d=this.options;if(a.isArray(d.capability.interfaces)){b.each(d.capability.interfaces,function(e){var f=this;b.each(this.commands,function(h){var j=this,g=f.name+f["major-version"]+"."+f["minor-version"]+"_"+j.name;c[g]=function(n,i,l,k){if(a.isFunction(n)){k=l;l=i;i=n;n=null}var o=b.extend({rpcEventFunc:null},k);var m=d.objset.guiObjset("newRequest");m.remoteCall(d.xpath,j.name,n,o.rpcEventFunc,i,l);m.send()}})})}},xpath:function(d){var e=this.options;d=(d!==undefined)?d:e.xpath;if(d&&(d.charAt(0)!=="/")){if(e.parentItem.length){d=e.parentItem.guiItem("xpath")+"/"+d}else{if(e.objset!==null){var c=e.objset.guiObjset("option","xpath");if(c){d=c+"/"+d}}}}return d},_toGuiValue:function(g,e,k){var j=this.options;if(j.values){var f,d;for(var c=0;c<j.values.length;c++){var h=j.values[c];if(!h.guiValue){h.guiValue={}}if((h.value===g)||(k&&(h.value===k.name))){d=h.guiValue}if(h.isDefault){f=h.guiValue}if(h.guiValue.cssClass){e.push(h.guiValue.cssClass)}}if(d){return d}return f}},_fromGuiValue:function(d){var e=this.options;if(e.values){for(var c=0;c<e.values.length;c++){if(e.values[c].guiValue.value===d){return e.values[c].value}}}return d},_setValue:function(e,d,c){this._value=e},_getValue:function(){return this._value},_reset:function(){this.value(this._current);this.options.modified=undefined},_isValid:function(d,c){return true},_showError:function(c){if(c){a.alert(c.msg)}},destroy:function(){if(!this.element.data("guiItem")){return}if(this.options.objset){this.options.objset.guiObjset("removeItem",this.element)}this.element.removeData("guiItem").unbind(".guiItem").removeClass(this.options.itemClass);b.widget.prototype.destroy.call(this)},value:function(e){var f=this.options;if(e===undefined){return this._fromGuiValue(this._getValue())}else{if(!f.loaded&&Boolean(this.options.writeOnly)){f.defValue=this._current=e}var d={value:e,current:this._current,capability:f.capability,xpath:f.xpath};d.value_enum=d.capability?d.capability.getEnum(e):undefined;d.translate=this._toGuiValue(d.value,d.classes,d.value_enum);if(this._trigger("value",null,d)){var c=d.translate;if(c&&c.cssClass){this.element.removeClass(d.classes.join(" "));this.element.addClass(c.cssClass)}if(c&&(c.value!=="")&&(c.value!==undefined)){d.value=c.value}else{if(d.value_enum){d.value=this.options.description?d.value_enum.description:d.value_enum.name}}this._setValue(d.value,d.capability,d.xpath);this._trigger("loaded",null,d)}}},current:function(e,d,c){var f=this.options;if(e===undefined){return this._current}else{if(d!==undefined){f.capability=d;this._initRPC()}if(c!==undefined){f.xpath=c}this._current=e;f.modified=undefined;f.loaded=true;this.value(e)}},reset:function(){var d=this.options;if(Boolean(d.connected)){var c={value:this._current,capability:d.capability,xpath:d.xpath};if(this._trigger("reset",null,c)){this._current=c.value;d.capability=c.capability;d.xpath=c.xpath;this._reset()}}},isValid:function(){var c={value:this.value(),error:{}};if(this._trigger("check",null,c)){if((c.error.code!==undefined)||!this._isValid(c.value,c.error)){this.showError(c.error);return false}else{this.showError();return true}}else{return(c.error.code===undefined)}},showError:function(c){if(this._trigger("error",null,c)){this._showError(c)}},getLoadActions:function(e,d){var f=b.extend({},this.options,d);if(f.autoSubscribe&&f.notify){this.getNotifyActions(e,d)}else{if(f.connected&&!f.writeOnly&&!f.loaded){var c=this;if(f.rpc){b.extend(true,f,{"session-options":{"capability-flags":{"interface":true}}})}e.getValue(c.xpath(),function(i,h,g){c.current(i,h,g)},function(){c.options.loaded=true},f)}}},getPostActions:function(e,d){var g=b.extend({},this.options,d);if(this.modified()){var c=this,f=this.value();e.setValue(this.xpath(),f,function(){c.current(f)},g)}},getNotifyActions:function(e,d){var f=b.extend({},this.options,d);if(f.connected&&f.notify&&!f.subscribed){var c=this;if(f.notifTimer>0){this._events.push(e.onPeriodicValue(this.xpath(),function(i,h,g){c.current(i,h,g)},function(){c.options.subscribed=true},{refreshTimer:f.notifTimer,currentValue:f.autoSubscribe}))}else{this._events.push(e.onValueChange(this.xpath(),function(i,h,g){c.current(i,h,g)},function(){c.options.subscribed=true},{currentValue:f.autoSubscribe}))}}},getResetActions:function(f,d){var g=this.options;if(g.subscribed){var c=this,e=this._events.length;b.each(this._events,function(h){f.deleteNotification(this,function(){e-=1;c.options.subscribed=(e===0)})});this._events=[]}}})}(jQuery,jQuery.gui));(function(b,a){a.logXPathError=function(e){var f="";for(var d=0;d<e.pos;d++){f+=" "}console.dir(e);console.info("XPath: '%s'",e.xpath);console.info("        %s^",f);console.error("%s: %s",e.name,e.message);if(e.stack){console.log(e.stack);var c=e.stack.split("\n");b.each(c,function(g){if(c[g].match(/^\s*[A-Za-z0-9\-_\$]+\(/)){}})}};a.XPathElement=function(f,d,e,c){this._isXPathElement=true;this.value=f;this.name=d;this._parent=e;if(c!==undefined){this._index=c}else{this._index=-1}};a.isXPathElement=function(c){return(a.isObject(c)&&c._isXPathElement)};b.extend(a.XPathElement.prototype,{getParent:function(){return this._parent},getText:function(){if(a.isString(this.value)){return this.value}else{if(a.isNumber(this.value)){return String(this.value)}else{if(a.isBoolean(this.value)){return this.value?"true":"false"}else{return null}}}},getChildren:function(){var f=[],d=this;if(a.isArray(this.value)){b.each(this.value,function(h){var j=new a.XPathElement(this,"",d,h);f.push(j)})}else{if(a.isObject(this.value)){var e=0;for(var c in this.value){if(this.value.hasOwnProperty(c)){var g=new a.XPathElement(d.value[c],c,d,e++);f.push(g)}}}}return f},getAttributes:function(){var d=[],c=this;return d}});a.XPathDocument=function(d,c){a.XPathElement.call(this);if(a.isXPathElement(d)){this._root=d}else{this._root=new a.XPathElement(d,c)}};b.extend(a.XPathDocument.prototype,a.XPathElement.prototype,{getChildren:function(){var c=[];c.push(this._root);return c}});a.XPathCtx=function(e,c){this._entry=[];if(a.isArray(e)&&e.length&&a.isXPathElement(e[0])){var d=this._entry;b.each(e,function(f){d.push(this)})}else{if(a.isXPathElement(e)){this._entry.push(e)}}this._vars={};if(c===undefined){this._doc=e}else{this._doc=c._doc;b.extend(this._vars,c._vars)}};b.extend(a.XPathCtx.prototype,{_space:/^\s+/,_optSpace:/^\s*/,_stepSep:/^\/\s*/,_paramSep:/^,\s*/,_funcEnd:/^\)\s*/,_predicateStart:/^\[\s*/,_predicateEnd:/^\]\s*/,_varStart:/^\$/,_groupStart:/^\(\s*/,_groupEnd:/^\)\s*/,_numberExp:/^((?:\-|\+)?\d+(?:\.\d+)?(?:(?:e|E)(?:\-|\+)?\d+)?)\s*/,_numberString:/^\s*((?:\-|\+)?\d+(?:\.\d+)?(?:(?:e|E)(?:\-|\+)?\d+)?)\s*$/,_stringExp:/^"((?:\\"|[^"])*)"|'((?:\\'|[^'])*)'\s*/,_varExp:/^\$(\w[\w\-]*\w|\w)\s*/,_descendant_or_self:/^\/\/\s*/,_self:/^\.\s*/,_parent:/^\.\.\s*/,_axis:{ancestor:{exp:/^ancestor\s*::\s*/,get:function(d){var c=this._parent;while(c!==undefined){d.push(c);c=c._parent}}},ancestor_or_self:{exp:/^ancestor-or-self\s*::\s*/,get:function(c){a.XPathCtx.prototype._axis.self.get.call(this,c);a.XPathCtx.prototype._axis.ancestor.get.call(this,c)}},attribute:{exp:/^(?:attribute\s*::|@)\s*/,get:function(d){var c=this.getAttributes();b.each(c,function(e){d.push(this)})}},child:{exp:/^child\s*::\s*/,get:function(d){var c=this.getChildren();b.each(c,function(e){d.push(this)})}},descendant:{exp:/^descendant\s*::\s*/,get:function(d){var c=this.getChildren();b.each(c,function(e){d.push(this);a.XPathCtx.prototype._axis.descendant.get.call(this,d)})}},descendant_or_self:{exp:/^descendant-or-self\s*::\s*/,get:function(c){a.XPathCtx.prototype._axis.self.get.call(this,c);a.XPathCtx.prototype._axis.descendant.get.call(this,c)}},following:{exp:/^following\s*::\s*/,get:function(d){var c=[];a.XPathCtx.prototype._axis.following_sibling.get.call(this,d);a.XPathCtx.prototype._axis.ancestor.get.call(this,c);b.each(c,function(f){var e=[];a.XPathCtx.prototype._axis.following_sibling.get.call(this,e);b.each(e,function(g){a.XPathCtx.prototype._axis.descendant_or_self.get.call(this,d)})})}},following_sibling:{exp:/^following-sibling\s*::\s*/,get:function(f){if(this._parent!==undefined){var e=this._parent.getChildren(),c=e.length;for(var d=(this._index+1);d<c;d++){f.push(e[d])}}}},namespace:{exp:/^namespace\s*::\s*/,get:function(c){}},parent:{exp:/^parent\s*::\s*/,get:function(c){if(this._parent!==undefined){c.push(this._parent)}}},preceding:{exp:/^preceding\s*::\s*/,get:function(d){var c=[];a.XPathCtx.prototype._axis.preceding_sibling.get.call(this,d);a.XPathCtx.prototype._axis.ancestor.get.call(this,c);c.reverse();b.each(c,function(f){var e=[];a.XPathCtx.prototype._axis.preceding_sibling.get.call(this,e);b.each(e,function(g){a.XPathCtx.prototype._axis.descendant_or_self.get.call(this,d)})})}},preceding_sibling:{exp:/^preceding-sibling\s*::\s*/,get:function(f){if(this._parent!==undefined){var e=this._parent.getChildren(),c=e.length;for(var d=0;d<this._index;d++){f.push(e[d])}}}},self:{exp:/^self\s*::\s*/,get:function(c){c.push(this)}}},_nodeTest:[{exp:/^node\s*\(\s*\)\s*/,get:function(c){return this}},{exp:/^text\s*\(\s*\)\s*/,get:function(c){var d=this.getText();if(d!==null){return new a.XPathElement(d,"",this,0)}else{return null}}},{exp:/^comment\s*\(\s*\)\s*/,get:function(c){return null}},{exp:/^processing-instruction\s*\(\s*\)\s*/,get:function(c){return null}},{exp:/^(\w[\w\-]*\w|\w):(\w[\w\-]*\w|\w)\s*/,get:function(c){return null}},{exp:/^(\w[\w\-]*\w|\w):\*\s*/,get:function(c){return null}},{exp:/^(\w[\w\-]*\w|\w)\s*/,get:function(c){if(this.name===c[1]){return this}return null}},{exp:/^\*\s*/,get:function(c){return this}}],_elementsFunc:[{exp:/^id\s*\(\s*/,parse:function(c,d,e){throw this._error(d,e,new Error("Unimplemented function"))}},{exp:/^\(\s*/,parse:function(c,d,e){return this._elements(c,d,e)}}],_stringFunc:[{exp:/^local-name\s*\(\s*/,parse:function(c,d,e){throw this._error(d,e,new Error("Unimplemented function"))}},{exp:/^namespace-uri\s*\(\s*/,parse:function(c,d,e){throw this._error(d,e,new Error("Unimplemented function"))}},{exp:/^name\s*\(\s*/,parse:function(c,d,e){throw this._error(d,e,new Error("Unimplemented function"))}},{exp:/^string\s*\(\s*/,parse:function(c,d,e){throw this._error(d,e,new Error("Unimplemented function"))}},{exp:/^concat\s*\(\s*/,parse:function(c,d,e){throw this._error(d,e,new Error("Unimplemented function"))}},{exp:/^substring-before\s*\(\s*/,parse:function(c,d,e){throw this._error(d,e,new Error("Unimplemented function"))}},{exp:/^substring-after\s*\(\s*/,parse:function(c,d,e){throw this._error(d,e,new Error("Unimplemented function"))}},{exp:/^substring\s*\(\s*/,parse:function(c,d,e){throw this._error(d,e,new Error("Unimplemented function"))}},{exp:/^normalize-space\s*\(\s*/,parse:function(c,d,e){throw this._error(d,e,new Error("Unimplemented function"))}},{exp:/^translate\s*\(\s*/,parse:function(c,d,e){throw this._error(d,e,new Error("Unimplemented function"))}},{exp:/^\(\s*/,parse:function(c,d,e){return this._string(c,d,e)}}],_numberFunc:[{exp:/^last\s*\(\s*/,parse:function(c,e,g){var d=[],f=this._entry.length;b.each(this._entry,function(h){d.push(f)});c.tab=d;return 0}},{exp:/^position\s*\(\s*/,parse:function(c,e,f){var d=[];b.each(this._entry,function(g){d.push(g+1)});c.tab=d;return 0}},{exp:/^count\s*\(\s*/,parse:function(c,f,h){var e=this,d=[],g;b.each(this._entry,function(j){var l={},k=a.XPathCtx(this,e);g=k._elements(l,f,h);d.push(l.length)});c.tab=d;return 0}},{exp:/^string-length\s*\(\s*/,parse:function(c,d,e){throw this._error(d,e,new Error("Unimplemented function"))}},{exp:/^number\s*\(\s*/,parse:function(d,g,i){var f=this,e,h;if((h=f._try(function(){return f._number(d,g,i)}))){return h}else{if((h=f._try(function(){return f._string(d,g,i)}))){}else{h=0;var c=[];b.each(f._entry,function(j){c.push(this.getText())});d.tab=c}}e=[];b.each(d.tab,function(j){match=f._numberString.exec(this);if(match){e.push(parseFloat(this))}else{throw this._error(g,i,new Error("Cannot convert string to number"))}});d.tab=e;return h}},{exp:/^sum\s*\(\s*/,parse:function(c,d,e){throw this._error(d,e,new Error("Unimplemented function"))}},{exp:/^floor\s*\(\s*/,parse:function(c,d,e){throw this._error(d,e,new Error("Unimplemented function"))}},{exp:/^ceiling\s*\(\s*/,parse:function(c,d,e){throw this._error(d,e,new Error("Unimplemented function"))}},{exp:/^round\s*\(\s*/,parse:function(c,d,e){throw this._error(d,e,new Error("Unimplemented function"))}},{exp:/^\(\s*/,parse:function(c,d,e){return this._number(c,d,e)}}],_booleanFunc:[{exp:/^starts-with\s*\(\s*/,parse:function(c,d,e){throw this._error(d,e,new Error("Unimplemented function"))}},{exp:/^contains\s*\(\s*/,parse:function(c,d,e){throw this._error(d,e,new Error("Unimplemented function"))}},{exp:/^boolean\s*\(\s*/,parse:function(c,d,e){throw this._error(d,e,new Error("Unimplemented function"))}},{exp:/^not\s*\(\s*/,parse:function(c,d,e){throw this._error(d,e,new Error("Unimplemented function"))}},{exp:/^true\s*\(\s*/,parse:function(c,d,f){var e=[];b.each(this._entry,function(g){e.push(true)});c.tab=e;return 0}},{exp:/^false\s*\(\s*/,parse:function(c,d,f){var e=[];b.each(this._entry,function(g){e.push(false)});c.tab=e;return 0}},{exp:/^lang\s*\(\s*/,parse:function(c,d,e){throw this._error(d,e,new Error("Unimplemented function"))}},{exp:/^\(\s*/,parse:function(c,d,e){return this._boolean(c,d,e)}}],_elementsOperators:[{exp:/^\|\s*/,operation:function(e,c){var d=[];b.each(e,function(f){d.push(this)});b.each(c,function(f){d.push(this)});return d}}],_booleanOperators:[{exp:/^=\s*/,operation:function(d,c){return d===c}},{exp:/^!=\s*/,operation:function(d,c){return d!==c}},{exp:/^and\s*/,operation:function(d,c){return d&&c}},{exp:/^or\s*/,operation:function(d,c){return d||c}}],_booleanNumberOperators:[{exp:/^<=\s*/,operation:function(d,c){return d<=c}},{exp:/^<\s*/,operation:function(d,c){return d<c}},{exp:/^>=\s*/,operation:function(d,c){return d>=c}},{exp:/^>\s*/,operation:function(d,c){return d>c}},{exp:/^=\s*/,operation:function(d,c){return d===c}},{exp:/^!=\s*/,operation:function(d,c){return d!==c}}],_booleanStringOperators:[{exp:/^=\s*/,operation:function(d,c){return d===c}},{exp:/^!=\s*/,operation:function(d,c){return d!==c}}],_numberOperators:[{exp:/^\*\s*/,operation:function(d,c){return d*c}},{exp:/^div\s*/,operation:function(d,c){return d/c}},{exp:/^mod\s*/,operation:function(d,c){return d%c}},{exp:/^\+\s*/,operation:function(d,c){return d+c}},{exp:/^\-\s*/,operation:function(d,c){return d-c}}]},{_error:function(c,e,d){d.name="XPathError";d.xpath=c;d.pos=e;return d},_function:function(l,e,g,j){var h=0,c=g.substring(j),f,k;for(var d=0;d<e.length;d++){f=e[d].exp.exec(c);if(f){h+=f[0].length;c=c.substring(f[0].length);k=e[d].parse.call(this,l,g,j+h);c=c.substring(k);h+=k;f=ctx._funcEnd.exec(c);if(f){h+=f[0].length;return h}throw this._error(g,j+h,new Error("Unclosed function"))}}return 0},_operator:function(r,e,o,j,m){var q=this,k=0,f=j.substring(m),h,n,p=[],c,l={};var d=function(i){p.push(c.operation.call(q,r.tab[i],l.tab[i]))};for(var g=0;g<e.length;g++){c=e[g];h=c.exp.exec(f);if(h){k+=h[0].length;f=f.substring(h[0].length);right_len=o.call(this,l,j,m+k);if(right_len){b.each(r.tab,d);r.tab=p;k+=right_len;return k}throw this._error(j,m+k,new Error("Invalid operator right value"))}}return 0},_try:function(c){try{return c.call(this)}catch(d){if(d.xpath===undefined){throw d}return 0}},_elements:function(n,h,k){var m=this,i=0,f=h.substring(k),j=m._entry,g,e=0,d;g=m._space.exec(f);if(g){f=f.substring(g[0].length);i+=g[0].length}if(!m._descendant_or_self.test(f)){g=m._stepSep.exec(f);if(g){i+=g[0].length;var l=new a.XPathCtx(m._doc,m);i+=l._elements(n,h,k+i);return i}}var c=function(){g=m._descendant_or_self.exec(f);if(g){d=[];b.each(j,function(t){if(a.isXPathElement(this)){m._axis.descendant_or_self.get.call(this,d)}else{throw m._error(h,k+i,new Error("Axis must be used on XPathElement"))}});j=d;f=f.substring(g[0].length);i+=g[0].length;return true}if((g=m._parent.exec(f))){d=[];b.each(j,function(t){if(a.isXPathElement(this)){m._axis.parent.get.call(this,d)}else{throw m._error(h,k+i,new Error("Axis must be used on XPathElement"))}});j=d;f=f.substring(g[0].length);i+=g[0].length}else{if((g=m._self.exec(f))){f=f.substring(g[0].length);i+=g[0].length}else{var q;for(var o in m._axis){if(m._axis.hasOwnProperty(o)){g=m._axis[o].exp.exec(f);if(g){q=m._axis[o];break}}}if(!q){q=m._axis.child}d=[];b.each(j,function(t){if(a.isXPathElement(this)){q.get.call(this,d)}else{if(g){throw m._error(h,k+i,new Error("Axis must be used on XPathElement"))}else{throw m._error(h,k+i,new Error("Default child axis must be used on XPathElement"))}}});j=d;if(g){f=f.substring(g[0].length);i+=g[0].length}var s;for(var p=0;p<m._nodeTest.length;p++){g=m._nodeTest[p].exp.exec(f);if(g){s=m._nodeTest[p];break}}if(!s){throw m._error(h,k+i,new Error("A step must not be empty"))}d=[];b.each(j,function(t){if(a.isXPathElement(this)){var u=s.get.call(this,g);if(u!==null){d.push(u)}}else{throw m._error(h,k+i,new Error("Node test must be used on XPathElement"))}});j=d;f=f.substring(g[0].length);i+=g[0].length}}var r=function(){var t,v,u;d=[];if((u=m._try(function(){t={};v=new a.XPathCtx(j,m);return v._number(t,h,k+i)}))){b.each(j,function(w){if(t.tab[w]===(w+1)){d.push(this)}})}else{if((u=m._try(function(){t={};v=new a.XPathCtx(j,m);return v._boolean(t,h,k+i)}))){b.each(j,function(w){if(t.tab[w]){d.push(this)}})}}if(u){f=f.substring(u);i+=u;j=d;return true}return false};while((g=m._predicateStart.exec(f))){f=f.substring(g[0].length);i+=g[0].length;if(!r()){throw m._error(h,k+i,new Error("Invalid predicate content"))}g=m._predicateEnd.exec(f);if(!g){throw m._error(h,k+i,new Error("Unclosed predicate"))}f=f.substring(g[0].length);i+=g[0].length}e++;g=m._stepSep.exec(f);if(g){f=f.substring(g[0].length);i+=g[0].length;return true}return false};while(f.length){if(!c()){break}}if(e){n.tab=j;i+=m._operator(n,m._elementsOperators,m._elements,h,k+i);return i}throw this._error(h,k,new Error("Invalid location paths syntax"))},_string:function(l,e,h){var k=this,f=0,c=e.substring(h),j,g,d,i;d=k._space.exec(c);if(d){c=c.substring(d[0].length);f+=d[0].length}if((j=k._function(l,k._stringFunc,e,h+f))){f+=j}else{if((d=k._stringExp.exec(c))){g=d[1];j=d[0].length;f+=j;i=[];b.each(k._entry,function(m){i.push(g)});l.tab=i}else{if((d=k._varExp.exec(c))){g=k._vars[d[1]];if(g!==undefined){j=d[0].length;f+=j;i=[];b.each(k._entry,function(m){i.push(g)});l.tab=i}}else{i=[];if((j=k._try(function(){var m=0;b.each(k._entry,function(n){var p={};var o=new a.XPathCtx(this,k);m=o._elements(p,e,h+f);var q="";b.each(p.tab,function(r){q+=this.getText()});i.push(q)});return m}))){l.tab=i;f+=j}}}}if(j){return f}throw this._error(e,h,new Error("Invalid string syntax"))},_number:function(l,f,h){var j=this,g=0,c=f.substring(h),k,e,i;e=j._space.exec(c);if(e){c=c.substring(e[0].length);g+=e[0].length}if((k=j._function(l,j._numberFunc,f,h+g))){}else{if((e=j._numberExp.exec(c))){var d=parseFloat(e[1]);k=e[0].length;i=[];b.each(j._entry,function(m){i.push(d)});l.tab=i}}if(k){g+=k;g+=j._operator(l,j._numberOperators,j._number,f,h+g);return g}throw this._error(f,h,new Error("Invalid number syntax"))},_boolean:function(k,e,h){var j=this,f=0,c=e.substring(h),i,d,g;d=j._space.exec(c);if(d){c=c.substring(d[0].length);f+=d[0].length}if((i=j._function(k,j._booleanFunc,e,h))){}else{if((i=j._try(function(){var m=j._number(k,e,h+f);if(m){var l=j._operator(k,j._booleanNumberOperators,j._number,e,h+f+m);if(l){return m+l}}return 0}))){}else{if((i=j._try(function(){var m=j._string(k,e,h+f);if(m){var l=j._operator(k,j._booleanStringOperators,j._string,e,h+f+m);if(l){return m+l}}return 0}))){}else{if((i=j._try(function(){var l=0;g=[];b.each(j._entry,function(m){var o={};var n=new a.XPathCtx(this,j);l=n._elements(o,e,h+f);g.push(o.tab.length>0)});k.tab=g;return l}))){}else{k={}}}}}if(i){f+=i;f+=j._operator(k,j._booleanOperators,j._boolean,e,h+f);return f}throw this._error(e,h,new Error("Invalid boolean syntax"))},addVariable:function(c,d){this._vars[c]=d},removeVariable:function(c){delete this._vars[c]},getElements:function(e){var d={};var c=this._elements(d,e,0);if(c!==e.length){throw this._error(e,c,new Error("Aborted parsing"))}return d.tab},getString:function(e){var d={};var c=this._string(d,e,0);if(c!==e.length){throw this._error(e,c,new Error("Aborted parsing"))}return d.tab[0]},getBoolean:function(e){var d={};var c=this._string(d,e,0);if(c!==e.length){throw this._error(e,c,new Error("Aborted parsing"))}return d.tab[0]}})}(jQuery,jQuery.gui));(function(b,a){a.uiWidget("guiFrame",a.guiItem,{version:"1.0.0",defaults:a.cnf({connected:false,html:'<div class="gui-frame-border-left"><div class="gui-frame-border-right"><div class="gui-frame-border-top"><div class="gui-frame-corner-left"></div><div class="gui-frame-corner-right"></div></div><div class="frame-title"></div><div class="frame-content"></div><div class="frame-status"></div><div class="gui-frame-border-bottom"><div class="gui-frame-corner-left"></div><div class="gui-frame-corner-right"></div></div></div></div>',title:null,content:null,statusBar:null,selectors:a.cnf({title:".frame-title",content:".frame-content",statusBar:".frame-status"})})},{_init:function(){var d=this.options,c=this;a.guiItem.prototype._init.call(this);if(d.title){this.element.find(d.selectors.title).text(d.title)}else{this.element.find(d.selectors.title).remove()}this.element.find(d.selectors.content).html(d.content);if(d.status){this.element.find(d.selectors.statusBar).text(d.status)}else{this.element.find(d.selectors.statusBar).remove()}},destroy:function(){if(!this.element.data("guiFrame")){return}this.element.removeData("guiFrame").unbind(".guiFrame")}})}(jQuery,jQuery.gui));(function(b,a){a.uiWidget("guiLabel",a.guiItem,{version:"1.0.0",setter:"",getter:"",defaults:a.cnf({connected:false,itemClass:"gui-label",html:"",text:"",addHtml:b.fn.prepend,input:"input"})},{_init:function(){var d=this.options,c=this;a.guiItem.prototype._init.call(this);this.input=b(d.input);var e=this.input.attr("id");if(e){this.element.attr("for",e)}this.element.text(d.text)},destroy:function(){if(!this.element.data("guiLabel")){return}this.element.removeData("guiLabel").unbind(".guiLabel");a.guiItem.prototype.destroy.call(this)}})}(jQuery,jQuery.gui));(function(b,a){a.uiWidget("guiInput",a.guiItem,{version:"1.0.0",setter:"",getter:"",defaults:a.cnf({saveToCookie:true,getFromCookie:true,cookie:a.cnf({expire:30}),itemClass:"gui-item gui-input",defValue:"",maxLength:0,inputType:"text",html:"<input type='%s'/>",inputSelector:"input",hasLabel:true,label:a.guiLabel.defaults})},{_init:function(){var e=this.options,c=this;a.guiItem.prototype._init.call(this);var f=this.element.attr("id");this.input=this.element.find(e.inputSelector).attr("id",f+"Input");if(b.browser.msie){this.input.change(function(){c.element.change();return true})}if(e.hasLabel){var d="<label></label>";if(b.browser.opera){d='<label class="gui-label">'+e.label.text+"</label>"}this.label=e.label.addHtml.call(this.element,d).children("label").guiLabel(b.extend(e.label,{input:this.input}))}if(e.disabled){this.disable()}},_initHtml:function(c){var d=this.options;if(d.html){a.guiItem.prototype._initHtml.call(this,b.sprintf(d.html,d.inputType))}},_setValue:function(e,d,c){this.input.val(e)},_getValue:function(){if(this.input){return this.input.val()}else{return this.element.val()}},_disabled:function(c){if(this.input){this.input.get(0).disabled=c}},destroy:function(){if(!this.element.data("guiInput")){return}this.element.removeData("guiInput").unbind(".guiInput");a.guiItem.prototype.destroy.call(this)},select:function(f,d){var e=this.options,c=this;d=d===undefined?true:!!d}})}(jQuery,jQuery.gui));(function(b,a){a.uiWidget("guiText",a.guiInput,{version:"1.0.0",setter:"",getter:"",defaults:a.cnf({itemClass:"gui-item gui-input gui-text",defValue:"",size:0,maxLength:0,strip:" \t"})},{_init:function(){var d=this.options,c=this;a.guiInput.prototype._init.call(this);if(d.size>0){this.input.attr("size",d.size)}if(d.maxLength>0){this.input.attr("maxlength",d.maxLength)}this.element.blur(function(){a.callTrace("blur",this);return c.element.change()}).keypress(function(){a.callTrace("keypress",this);return c.element.change()}).change(function(){a.callTrace("change",this);if(c.isValid()){return true}else{return false}});if(d.inputClass){this.input.addClass(d.inputClass)}if(d.defValue){this.value(d.defValue)}},_setData:function(c,d){a.guiInput.prototype._setData.call(this,c,d);var e=this.options;if(c==="size"){if(e.size>0){this.input.attr("size",e.size)}else{this.input.attr("size","")}}else{if(c==="maxLength"){if(e.maxLength>0){this.input.attr("maxlength",e.maxLength)}else{this.input.attr("maxlength","")}}}},_setValue:function(f,d,c){if(d){var e;if((e=d.getMaxLength())!==undefined){this._setData("maxLength",e)}if(d.isKindOf("xmo:number")){this.options.kindOf="number"}}this.input.val(f)},_getValue:function(){var j=this.options,d=this;var c=this.input.val();var f=j.strip;if(f){var h="",g=c.length,e;for(;g>0;g--){if(f.indexOf(c.charAt(g-1))===-1){break}}var k=false;for(e=0;e<g;e++){if(!k){if(f.indexOf(c.charAt(e))!==-1){continue}k=true}h+=c.charAt(e)}if(j.kindOf==="number"){return parseInt(h,10)}return h}else{if(j.kindOf==="number"){return parseInt(c,10)}return c}},_isValid:function(h,c){var i=this.options,d=i.capability,g;if(this.options.connected&&d){if((g=d.getMinLength())!==undefined){if(h.length<g){c.code=a.XMO_MIN_LENGTH_ERR;c.msg=a.i18n.msg("XMO_MIN_LENGTH_ERR",g);return false}}if((g=d.getMaxLength())!==undefined){if(h.length>g){c.code=a.XMO_MAX_LENGTH_ERR;c.msg=a.i18n.msg("XMO_MAX_LENGTH_ERR",g);return false}}if((g=d.getRegexPattern())!==undefined){var f,e="g";if(d.isRegexIgnoreCase()){e+="i"}f=new RegExp(g,e);if(!f.test(h)){c.code=a.XMO_REGEX_ERR;c.msg=a.i18n.msg("XMO_REGEX_ERR");return false}}if((g=d.getMinValueInclusive())!==undefined){if(Number(h)<g){c.code=a.XMO_MIN_VALUE_ERR;c.msg=a.i18n.msg("XMO_MIN_VALUE_ERR",g);return false}}if((g=d.getMaxValueInclusive())!==undefined){if(Number(h)>g){c.code=a.XMO_MAX_VALUE_ERR;c.msg=a.i18n.msg("XMO_MAX_VALUE_ERR",g);return false}}if((g=d.getMinValueExclusive())!==undefined){if(Number(h)<=g){c.code=a.XMO_MIN_VALUE_ERR;c.msg=a.i18n.msg("XMO_MIN_VALUE_ERR",g);return false}}if((g=d.getMaxValueExclusive())!==undefined){if(Number(h)>=g){c.code=a.XMO_MAX_VALUE_ERR;c.msg=a.i18n.msg("XMO_MAX_VALUE_ERR",g);return false}}}return true},destroy:function(){if(!this.element.data("guiText")){return}this.element.removeData("guiText").unbind(".guiText");a.guiInput.prototype.destroy.call(this)}})}(jQuery,jQuery.gui));(function(b,a){a.uiWidget("guiStatus",a.guiItem,{version:"1.0.0",defaults:a.cnf({itemClass:"gui-item gui-status",readOnly:true,notify:true,defValue:"",textSelector:"> p.text",beforeText:"",html:"<p class='text'></p>",hasLabel:true,label:a.guiLabel.defaults})},{_init:function(){var d=this.options,c=this;a.guiItem.prototype._init.call(this);if(d.hasLabel){this.label=d.label.addHtml.call(this.element,"<label></label>").children("label").guiLabel(b.extend(d.label,{input:null}))}},_setValue:function(e,d,c){var f=this.options;if(f.beforeText){e=f.beforeText+" "+e}if(f.textSelector){b(f.textSelector,this.element).text(e)}},_getValue:function(){var c=this.options;if(c.beforeText){return value.substr(c.beforeText.length+1,value.length)}if(c.textSelector){return b(c.textSelector,this.element).text()}},destroy:function(){if(!this.element.data("guiStatus")){return}this.element.removeData("guiStatus").unbind(".guiStatus");a.guiItem.prototype.destroy.call(this)}});a.uiWidget("guiTimeStatus",a.guiStatus,{version:"1.0.0",defaults:a.cnf({itemClass:"gui-item gui-status gui-time-status",shortFormat:"%H:%M:%S",longFormat:"%j days %H:%M:%S"})},{_init:function(){var d=this.options,c=this;a.guiStatus.prototype._init.call(this)},_setValue:function(e,d,c){var g=this.options,f;a.guiStatus.prototype._setValue.call(this,a.formatTime(e,g.shortFormat,g.longFormat),d,c)},destroy:function(){if(!this.element.data("guiTimeStatus")){return}this.element.removeData("guiTimeStatus").unbind(".guiTimeStatus");a.guiStatus.prototype.destroy.call(this)}})}(jQuery,jQuery.gui));(function(b,a){a.uiWidget("guiButton",a.guiInput,{version:"1.0.0",setter:"",getter:"",defaults:a.cnf({connected:false,disabled:false,checked:false,saveToCookie:true,getFromCookie:true,cookie:a.cnf({expire:30}),itemClass:"gui-item gui-button",inputButton:false,inputType:"button",html:'<div class="button-left"></div><div class="button-right"><p class="gui-button-text"></p></div>',hasLabel:false,radioButton:false,radioButtonGroup:"",text:"",url:null,target:null})},{_init:function(){var f=this.options,c=this;if(f.inputButton){a.guiInput.prototype._init.call(this);this.input.val(f.text).click(function(){c.click()})}else{a.guiItem.prototype._init.call(this);this.element.find(".gui-button-text").text(f.text);var d=function(){return c.element.hasClass("gui-button-selected")};var e=function(){if(f.disabled||d()){return false}c.element.addClass("gui-button-hover");return false};this.element.hover(e,function(){c.element.removeClass("gui-button-hover gui-button-down");return false}).mousedown(function(){if(f.disabled){return false}c.element.addClass("gui-button-down");return false}).mouseup(function(){c.element.removeClass("gui-button-down");return false}).click(function(g){if(f.disabled){g.stopImmediatePropagation();return false}b.logf("Click event on: %o",c.element.get(0));c.element.focus();if(f.radioButton){if(d()){c.element.removeClass("gui-button-selected");e()}else{c.element.addClass("gui-button-selected")}}else{e();if(f.target){b(f.target).guiLoadURL(f.url)}}return true}).dblclick(function(g){if(f.disabled){g.stopImmediatePropagation();return false}});if(f.disabled){this.disable()}}},destroy:function(){if(!this.element.data("guiButton")){return}this.element.removeData("guiButton").unbind(".guiButton");if(this.options.inputButton){a.guiInput.prototype.destroy.call(this)}else{a.guiItem.prototype.destroy.call(this)}},select:function(f,d){var e=this.options,c=this;d=d===undefined?true:!!d}})}(jQuery,jQuery.gui));(function(b,a){a.uiWidget("guiCheckbox",a.guiInput,{version:"1.0.0",setter:"",getter:"",getterSetter:"checked",defaults:a.cnf({itemClass:"gui-item gui-input gui-checkbox",checked:false,inputType:"checkbox",html:"<input type='%s' value='0'/>",buttonConf:null,checkFunc:null,disabledObjects:"",hiddenObjects:""})},{_init:function(){var d=this.options,c=this;d.defValue=d.checked;a.guiInput.prototype._init.call(this);if(d.inputType==="hidden"){this.element.click(function(){if(!d.disabled){c._change(!d.checked);c.element.change()}})}else{this.input.change(function(){c._change()})}this._setValue(d.defValue)},_change:function(c){var d=this.options;c=c===undefined?this._getValue():Boolean(c);d.checked=c;this.element.removeClass("gui-checked gui-unchecked gui-disabled-checked gui-disabled-unchecked");if(d.disabled){this.element.addClass(c?"gui-disabled-checked":"gui-disabled-unchecked")}else{this.element.addClass(c?"gui-checked":"gui-unchecked")}if(d.disabledObjects){b(d.disabledObjects).guiItem("option","disabled",!c)}if(d.hiddenObjects){b(d.hiddenObjects)[c?"show":"hide"]()}},_setValue:function(e,d,c){e=Boolean(e);this.input.get(0).checked=e;this._change(e)},_getValue:function(){var c=this.options;if(c.inputType==="hidden"){return c.checked}else{return this.input.get(0).checked}},_disabled:function(c){var d=this.options;a.guiInput.prototype._disabled.call(this,c);this._change()},checked:function(c){if(c===undefined){return this._getValue()}else{this._setValue(c)}},destroy:function(){if(!this.element.data("guiCheckbox")){return}this.element.removeData("guiCheckbox").unbind(".guiCheckbox");a.guiInput.prototype.destroy.call(this)}})}(jQuery,jQuery.gui));(function(b,a){a.uiWidget("guiRadio",a.guiCheckbox,{version:"1.0.0",setter:"",getter:"",defaults:a.cnf({itemClass:"gui-item gui-input gui-radio",inputType:"radio",groupName:"group0",group:"",radioValue:null,enumMode:false,tabIndex:0,html:"<input type='%s' name='%s' value='%s' tabindex='%s'/>"})},{_init:function(){var d=this.options,c=this;a.guiCheckbox.prototype._init.call(this);if(d.radioValue){d.values=[{value:d.radioValue,guiValue:{value:true}},{isDefault:true,guiValue:{value:false}}]}this.element.click(function(){if(b.browser.msie){c._getGroup().find("input").change()}})},_initHtml:function(c){var d=this.options;if(d.html){a.guiItem.prototype._initHtml.call(this,b.sprintf(d.html,d.inputType,d.groupName,d.radioValue,d.tabIndex))}},_getGroup:function(){var c=this.options;if(!c.group){c.group=b(b.sprintf("input[name='%s']:parent, div[groupName='%s']",c.groupName,c.groupName))}return c.group},value:function(c){var d=this.options;if(d.enumMode&&d.connected){if(c===undefined){return this._getGroup().filter("div:has(input:checked)").guiItem("option","radioValue")}else{a.guiCheckbox.prototype.value.call(this,c);this._getGroup().not(this.element).guiItem("option","capability",d.capability).guiItem("value",c)}}else{return a.guiCheckbox.prototype.value.call(this,c)}},destroy:function(){if(!this.element.data("guiRadio")){return}this.element.removeData("guiRadio").unbind(".guiRadio");a.guiCheckbox.prototype.destroy.call(this)}})}(jQuery,jQuery.gui));(function(b,a){a.uiWidget("guiList",a.guiInput,{version:"1.0.0",setter:"",getter:"",defaults:a.cnf({itemClass:"gui-item gui-input gui-text gui-list",defValue:"",defIndex:0,html:"<select></select>",inputSelector:"select",multiple:false,listSize:0,optionsXpath:"",options:a.array({text:"",value:""},[]),valueList:null,firstTime:true,unique:true})},{_init:function(){var k=this.options,c=this;var h=k.connected;a.guiInput.prototype._init.call(this);if(h&&k.optionsXpath){k.connected=true}if(k.multiple){this.input.attr("multiple","multiple")}if(k.listSize){this.input.attr("size",k.listSize)}var g=k.options.length;for(var e=0;e<g;e++){var d=k.options[e].text;var j=k.options[e].value;var f="";if((j===k.defValue)||(!j&&(d===k.defValue))||(e===k.defIndex)){f=" selected='selected'"}if(j){j=" value='"+j+"'"}this.input.append("<option"+j+f+">"+d+"</option>")}this.element.bind("gui_value",function(i,l){l.value_enum=undefined})},getLoadActions:function(e,d){var f=this.options;if(f.connected&&!f.writeOnly&&!f.loaded&&f.optionsXpath){var c=this;e.getValue(f.optionsXpath,function(i,h,g){c.input.append("<option>"+i+"</option>")},d)}a.guiInput.prototype.getLoadActions.call(this,e,d)},_setValue:function(k,d,j){var e=this.options;if((e.options.length===0)&&d&&(e.optionsXpath===""&&!e.valueList)){this.input.children("option").remove();var g,c=d.getEnumValues();for(g=0;g<c.length;g++){var l=c[g].name;var f=c[g].value;if(f){f=" value='"+f+"'"}if(e.description){l=c[g].description}var h=(k===f)?" selected ":"";this.input.append("<option"+h+f+">"+l+"</option>")}}if((e.options.length===0)&&(e.valueList)){if(e.firstTime){e.firstTime=false;this.input.children("option").remove()}if(e.unique){if(this.input.find("option[value='"+k+"']").length===0){this.input.append("<option value='"+k+"'>"+k+"</option>")}}else{this.input.append("<option value='"+k+"'>"+k+"</option>")}}else{this.input.val(k)}},removeGuiValue:function(c){var d=this.options;if((d.options.length===0)&&(d.valueList)){this.input.find("option[value="+c+"]").remove()}},_getValue:function(){var d=a.guiInput.prototype._getValue.call(this),c=Number(d);if(!isNaN(c)){return c}return d},destroy:function(){if(!this.element.data("guiList")){return}this.element.removeData("guiList").unbind(".guiList");a.guiInput.prototype.destroy.call(this)}})}(jQuery,jQuery.gui));(function(b,a){a.uiWidget("guiTableCell",a.guiItem,{version:"1.0.0",setter:"edit save cancel",defaults:a.cnf({itemClass:"gui-item gui-table-cell",connected:false,id:"",index:-1,row:null,path:"",width:"",header:"",content:"",cellClass:"guiTableCell",editable:true,edited:false,edit:a.cnf({html:'<div class="gui-table-text-edit" hasLabel="false"></div>',itemSelector:"div.gui-table-text-edit",itemClass:"guiText",options:a.cnf({})}),resize:true,collapse:false})},{_init:function(){var d=this.options,c=this;a.guiItem.prototype._init.call(this);this.editor=b([])},_getCellValue:function(c){return c[this.options.path]},_setCellValue:function(c,d){c[this.options.path]=d;return c},_setValue:function(c){if(this.editor.length){this.editor.guiItem("value",c)}else{this._value=c;this.element.text(c)}},_getValue:function(){if(this.editor.length){return this.editor.guiItem("value")}else{return this._value}},_edit:function(){var f=this.options,c=this;if(f.editable&&f.edit.html){var e=this._getValue();this._initHtml(f.edit.html);var d=b(f.edit.itemSelector,this.element);d[f.edit.itemClass](f.edit.options).guiItem("current",e).guiItem("value",e);this.element.addClass("gui-edited");this.editor=d}},_save:function(){if(this.editor.length&&!this.options.edited){var c=this._getValue();this.editor=b([]);this.value(c)}},_cancel:function(){if(this.editor.length&&!this.options.edited){this.editor=b([]);this._setValue(this.value)}},current:function(e,d,c){a.guiItem.prototype.current.call(this,e,d,c);if(e!==undefined){if(this.editor.length){this.editor.guiItem("current",e,d,c)}}},modified:function(c){if(this.editor.length){return this.editor.guiItem("modified")}else{return a.guiItem.prototype.modified.call(this)}},edit:function(){var c={};if(this._trigger("edit",null,c)){this._edit()}},save:function(){var c={};if(this._trigger("save",null,c)){this._save()}},cancel:function(){var c={};if(this._trigger("cancel",null,c)){this._cancel()}},destroy:function(){if(!this.element.data("guiTableCell")){return}this.element.removeData("guiTableCell").unbind(".guiTableCell");a.guiItem.prototype.destroy.call(this)}});a.uiWidget("guiTableRow",a.guiItem,{version:"1.0.0",setter:"edit save cancel remove disable",defaults:a.cnf({itemClass:"gui-item gui-table-row",connected:false})},{_init:function(){var g=this.options,d=this;a.guiItem.prototype._init.call(this);this._cells=[];for(var f=0;f<g.columns.length;f++){var e=g.columns[f];var c=this.element.append("<td></td>").children("td:last");c.attr("id",e.id);c[e.cellClass](e);if(f===0){c.addClass("gui-first")}if(f===g.columns.length-1){c.addClass("gui-last")}c=c.data("guiTableCell");c._row=this;this._cells.push(c);this._cells[e.id]=c;if(e.edited){c._edit()}}},_setValue:function(f){this._value=f;for(var d=0;d<this._cells.length;d++){var c=this._cells[d];if(c.options.path){var e=c._getCellValue(f);c.current(e);c.value(e)}}},_getValue:function(){var e=this._value?this._value:{};for(var d=0;d<this._cells.length;d++){var c=this._cells[d],f=c.options;if(f.path&&!f.readOnly){c._setCellValue(e,c.value())}}return e},modified:function(d){for(var e=0;e<this._cells.length;e++){var c=this._cells[e],f=c.options;if(f.editable&&c.modified()){return true}}return false},_edit:function(){var c=this.element.children("td").guiTableCell("edit").filter(".gui-edited");if(c.length>0){this.element.addClass("gui-edited")}},_save:function(){var c=this.element.children("td").guiTableCell("save").filter(".gui-edited");if(c.length===0){this.element.removeClass("gui-edited")}},_cancel:function(){this.element.removeClass("gui-edited").children("td").guiTableCell("cancel")},edit:function(){var c={};if(this._trigger("edit",null,c)){this._edit()}},save:function(){var c={};if(this._trigger("save",null,c)){this._save()}},cancel:function(){var c={};if(this._trigger("cancel",null,c)){this._cancel()}},remove:function(){var c={};if(this._trigger("remove",null,c)){this._table.remove(this)}},destroy:function(){if(!this.element.data("guiTableRow")){return}delete this._cells;this.element.removeData("guiTableRow").unbind(".guiTableRow");a.guiItem.prototype.destroy.call(this)}});a.uiWidget("guiTable",a.guiItem,{version:"1.0.0",setter:"edit save cancel remove",defaults:a.cnf({itemClass:"gui-item gui-table",childName:"",html:"<table><thead></thead><tbody></tbody><tfoot></tfoot></table>",width:"100%",foot:"",columns:a.array(a.guiTableCell.defaults,[]),container:""})},{_init:function(){var h=this.options,c=this;a.guiItem.prototype._init.call(this);if(!h.container){h.container=h.xpath.replace(/\/[^\/]+$/,"")}this._current=[];for(var e=0;e<h.columns.length;e++){var f=h.columns[e];if((f.index!==-1)&&(f.index!==e)){h.columns.splice(e,1);h.columns.splice(f.index,0,f);e=0}}this._head=this.element.find("> table > thead");this._body=this.element.find("> table > tbody");this._foot=this.element.find("> table > tfoot");this.element.width(h.width);this._head.add(this._body).add(this._foot).css("width","100%");var k="<tr>";for(var d=0;d<h.columns.length;d++){k+="<th>"+h.columns[d].header+"</th>"}k+="</tr>";this._head.append(k);this._foot.html(h.foot);var g=this._head.find("> tr > th");if(g.length>1){g.eq(0).addClass("first");g.eq(g.length-1).addClass("gui-last")}this._rows=[];this._addedRows=[];this._deletedValues=[]},modified:function(c){var e=this.options;if(c===undefined){if((
/*!o.loaded*/
!e.connected)||e.readOnly){return false}else{if((this._addedRows.length>0)||(this._deletedValues.length>0)){return true}else{for(var d=0;d<this._rows.length;d++){if(this._rows[d].modified()){return true}}return false}}}else{e.modified=Boolean(c)}},_setValue:function(f,e,c){this.insert(-1,f,e,c);if(c){var d=this._current.length-1;this._rows[d].current=this._current[d]}},_getValue:function(){var d=[],c;for(c=0;c<this._rows.length;c++){d.push(this._rows[c].value())}return d},_reset:function(){var d=this.options,c=this;this._body.empty();this._rows=[];b.each(this._current,function(e){c._setValue(this,d.capability,d.xpath)})},_insertRow:function(h,k,c,j){var d=this.options,l=this;var m;if(k===undefined){k={}}var e=this._rows.length;if((h>=0)&&(h<e)){m=this._body.children("tr").eq(h).before("<tr></tr>").prev()}else{m=this._body.append("<tr></tr>").children("tr:last");if(e>0){this._rows[e-1].element.removeClass("gui-last")}m.addClass("gui-last");h=e++}m.guiTableRow({columns:d.columns});m=m.data("guiTableRow");this._rows.splice(h,0,m);m._table=this;if(j){m.current(k,c,j)}m.value(k,c,j);if((h%2)===0){m.element.addClass("even")}else{m.element.addClass("odd")}for(var f=h;f<e;f++){var g=this._rows[f];g.element.removeClass("odd even");if((f%2)===0){g.element.addClass("even")}else{g.element.addClass("odd")}}if(!j){this._addedRows.push(m);this.element.change()}return h},_removeRow:function(c){var d,j=this._rows[c],g=this._rows.length;if(a.isNumber(c)){j=this._rows[c]}else{j=c;c=b.inArray(j,this._rows)}if(c===g-1&&c>0){this._rows[g-2].element.addClass("gui-last")}var h=0;if(j.element.hasClass("odd")){h=1}this._rows.splice(c,1);for(d=c;d<g-1;d++){var f=this._rows[d];f.element.removeClass("even odd");if(((d+h)%2)===0){f.element.addClass("even")}else{f.element.addClass("odd")}}var e=b.inArray(j,this._addedRows);if(e>=0){this._addedRows.splice(e,1)}else{this._deletedValues.push(j.current)}j.element.remove();this.element.change()},current:function(e,d,c){if(e===undefined){return this.current}else{this.current.push({value:e,capability:d,xpath:c})}},getPostActions:function(e,d){var f=this.options;if(f.connected&&!f.readOnly){var c=this;b.each(this._deletedValues,function(g){var h=this;e.deleteElement(h.xpath,function(){c._deletedValues.splice(b.inArray(h,c._deletedValues),1);c.current.splice(b.inArray(h,c.current),1)},d)});b.each(this._addedRows,function(g){var j=this,h={};h[f.childName]=j.value();e.addChild(f.container,h,function(){c._addedRows.splice(b.inArray(j,c._addedRows),1);c._rows[b.inArray(j,c._rows)]._save();c.current.push({value:j.value()})},d)})}},insert:function(e,g,d,c){e=a.isNumber(e)?e:-1;var f={index:e,value:g,capability:d,xpath:c};if(this._trigger("insert",null,f)){this._insertRow(f.index,f.value,f.capability,f.xpath)}return f.index},getRows:function(c){var e=b([]);if(b.isArray(c)){for(var d=0;d<c.length;d++){e.add(this.getRows(c[d]))}}else{if(c!==undefined){e=this._body.children("> tr").eq(c)}else{e=this._body.children("> tr.selected").guiTableRow("remove")}}return e},edit:function(c){if(b.isArray(c)){for(var d=0;d<c.length;d++){b("tbody > tr",this.element).eq(c[d]).guiTableRow("edit")}}else{if(c!==undefined){b("tbody > tr",this.element).eq(c).guiTableRow("edit")}else{b("tbody > tr.selected",this.element).guiTableRow("edit")}}},save:function(c){if(b.isArray(c)){for(var d=0;d<c.length;d++){b("tbody > tr",this.element).eq(c[d]).guiTableRow("save")}}else{if(c!==undefined){b("tbody > tr",this.element).eq(c).guiTableRow("save")}else{b("tbody > tr.selected",this.element).guiTableRow("save")}}},cancel:function(c){if(b.isArray(c)){for(var d=0;d<c.length;d++){b("tbody > tr",this.element).eq(c[d]).guiTableRow("cancel")}}else{if(c!==undefined){b("tbody > tr",this.element).eq(c).guiTableRow("cancel")}else{b("tbody > tr.selected",this.element).guiTableRow("cancel")}}},remove:function(c){this._removeRow(c)},destroy:function(){if(!this.element.data("guiTable")){return}delete this._rows;this.element.removeData("guiTable").unbind(".guiTable");a.guiItem.prototype.destroy.call(this)}})}(jQuery,jQuery.gui));(function(b,a){a.uiWidget("guiTabs",a.guiItem,{version:"1.0.0",setter:"select disable",getter:"length",defaults:a.cnf({connected:false,selected:0,disabled:[],saveToCookie:true,getFromCookie:true,cookie:a.cnf({expire:30}),loadFromCookie:true,target:"",itemClass:"gui-item gui-tabs",tabOffset:0})},{_init:function(){var f=this.options,c=this;a.guiItem.prototype._init.call(this);this.selected=-1;this.tabs=this.element.addClass("gui-tabs").children("li, div").addClass("gui-tab");this.tabs.eq(0).addClass("gui-tab-left");this.tabs.eq(this.tabs.length-1).addClass("gui-tab-right");for(var d=0;d<f.disabled.length;d++){this.tabs.eq(f.disabled[d]).addClass("gui-disabled")}this.top_z_index=100;this.tabs.each(function(g){b(this).css("z-index",c.top_z_index-(g+1));if(f.tabOffset!==0){b(this).css("left",f.tabOffset*g+"px")}b(this).click(function(){if(!b(this).hasClass("gui-disabled")){c.select(g)}}).hover(function(){b(this).addClass("gui-hover")},function(){b(this).removeClass("gui-hover")})});if(f.getFromCookie){var e=this.element.guiCookie("defaultChoice");if(e){f.selected=e}}this.select(f.selected)},_change:function(d){var e=this.options,c=this;if(this._trigger("change",null,d)){b(e.target).guiLoadURL(d.tab)}},destroy:function(){if(!this.element.data("guiTabs")){return}this.element.removeData("guiTabs").unbind(".guiTabs");a.guiItem.prototype.destroy.call(this)},select:function(g,d){var f=this.options,c=this;d=d===undefined?true:!!d;var e={selected:d};if(a.isString(g)){e.id=g;e.tab=this.tabs.filter(e.id);e.index=this.tabs.index(e.tab)}else{e.index=g;e.tab=this.tabs.eq(g);e.id=e.tab.id}if(this._trigger("select",null,e)){if(d){if(this.selected===e.index){return true}if((this.selected!==-1)&&!c.select(this.selected,false)){return false}this.selected=e.index;e.tab.addClass("gui-selected").removeClass("gui-disabled").css("z-index",this.top_z_index);if(e.index===0){e.tab.addClass("gui-selected-left")}else{if(e.index===(this.tabs.length-1)){e.tab.addClass("gui-selected-right")}}this._change(e);if(e.id&&f.saveToCookie){this.element.guiCookie("defaultChoice","#"+e.id)}}else{if(this.selected!==e.index){return true}e.tab.css("z-index",this.top_z_index-(e.index+1)).removeClass("gui-selected gui-selected-left gui-selected-right");this.selected=-1}return true}return false},disable:function(g,d){var f=this.options,c=this;d=d===undefined?true:!!d;var e={disabled:d};if(a.isString(g)){e.id=g;e.tab=this.tabs.filter(e.id);e.index=this.tabs.index(e.tab)}else{e.index=g;e.tab=this.tabs.eq(g);e.id=e.tab.id}if(this._trigger("disable",null,e)){if(d){if((this.selected===e.index)&&!this.select(e.index,false)){return false}e.tab.addClass("gui-disabled")}else{e.tab.removeClass("gui-disabled")}return true}return false}})}(jQuery,jQuery.gui));(function(b,a){a.uiWidget("guiMenu",a.guiItem,{version:"1.0.0",setter:"",getter:"",defaults:a.cnf({connected:false,target:"",defValue:"",saveDefault:true,level:"l0",selectedClass:"open",active:false,alwaysOpen:false,animated:false,autoHeight:false})},{_init:function(){var g=this.options,c=this,f=c.element;a.guiItem.prototype._init.call(this);f.children("div.menuFrame").guiFrame();b(".title.l0",f).addClass("menu_title").next().addClass("menu_item");if(f.children().length===0){f.guiLoadURL()}var d=f.guiCookie("defaultChoice");if(d){g.defValue=d}f.add(".accordion",f).each(function(h){g.header=".title."+b(this).attr("level");b(this).accordion(g)});b(".choice",f).click(function(){b(".title, .choice",f).removeClass("selected");b(this).parent(".accordion").accordion("disable");b(this).add(b(this).parents(".submenu").children(".title")).addClass("selected");b(g.target).guiLoadURL(this);if(this.id&&g.saveDefault){b(f).guiCookie("defaultChoice","#"+this.id)}b(".accordion",f).each(function(h){if(b(".submenu .title.selected",this).length===0){b(this).accordion("activate",false)}});return false});b(".title, .choice",f).hover(function(){b(this).addClass("hover")},function(){b(this).removeClass("hover")});var e;if(g.defValue){e=b(g.defValue,f)}else{e=b(".choice:first",f)}e.click();b(".accordion",f).each(function(h){var j=b(".submenu .title.selected",this);b(this).accordion("activate",j)});b(".menu_item .choice",f).hover(function(){b(this).addClass("hover")},function(){b(this).removeClass("hover")})},destroy:function(){if(!this.element.data("guiMenu")){return}this.element.removeData("guiMenu").unbind(".guiMenu")}})}(jQuery,jQuery.gui));