



<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="viewport" content="width=1085"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Livebox</title>
<script type="text/javascript">
    appUrl = '';
    appConfig = 'fr';
    appUid = getEtag();
    config = {
        BUILD_CUSTOMER: 'ft',
        BUILD_PROJECT: 'lbv3fr',
        BUILD_HARDWARE: 'sagem_lbv3',
        SESSION_DURATION: '600'
    };
    if(config.BUILD_PROJECT.indexOf("lbv3")>=0){
        config.BUILD_PROJECT = "lbv2.8fr";
    }
    function getEtag(){
        var req = new XMLHttpRequest();
        req.open('GET', document.location, false);
        req.send(null);
        return req.getResponseHeader("etag");
    }
</script>
<link href="/styles.css?v=bdbae052" rel="stylesheet" type="text/css"/>
<script src="/scripts.js?v=bdbae052" type="text/javascript" charset="utf-8"></script>
<link rel="icon" type="image/x-icon" href="/images/fr/common/favicon.ico?v=bdbae052"/>
<link rel="shortcut icon" href="/images/fr/common/favicon.ico?v=bdbae052" type="image/x-icon"/>
</head>
<body class="accessibility-small">
<!-- Popup and backlayer from Cytadelle Technology Light framework -->
<div id="ct-popup" class="fixed" style="height: 70px">
    <div>
        <img id="ct-popup-header" src="/images/fr/common/transparent.gif?v=bdbae052" class="png voice Voice.general.popup.img.header" alt=""/>
        <div id="ct-popup-header-title"></div>
        <a id="popup-close-btn" class="nologin">
        <img id="ct-popup-header-close" src="/images/fr/common/transparent.gif?v=bdbae052" class="png voice Voice.general.popup.img.close" alt=""/>
        </a>
    </div>
    <div id="ct-popup-content">
        <span class="translation Translations.home.authentication.label.subtitle"></span>
    </div>
    <img src="/images/fr/common/transparent.gif?v=bdbae052" class="png ct-popup-footer voice Voice.general.popup.img.footer" alt=""/>
</div>
<div id="ct-msgbox" class="fixed">
    <img id="ct-popup-header-small" src="/images/fr/common/transparent.gif?v=bdbae052" class="png" alt=""/>
    <div id="ct-msgbox-content">
        <img src="/images/fr/common/transparent.gif?v=bdbae052" id="ct-msgbox-img" class="png"/>
        <div id="ct-msgbox-msg">
        </div>
        <input type="button" id="ct-msgbox-button1" value="annuler" class="input-btn input-small-btn-gray translation Translations.general.btn.cancel"/><input type="button" id="ct-msgbox-button2" value="enregistrer" class="input-btn input-small-btn-orange translation Translations.general.btn.save"/><input type="button" id="ct-msgbox-button3" value="enregistrer" class="input-btn input-small-btn-orange translation Translations.general.btn.save"/>
    </div>
    <img id="ct-popup-footer" src="/images/fr/common/transparent.gif?v=bdbae052" class="png" alt=""/>
</div>
<div id="ct-tooltip" class="fixed">
</div>
<div id="ct-waiting" class="fixed">
    <img src="/images/fr/common/transparent.gif?v=bdbae052" alt="" class="voice Voice.general.waiting.img.waiting"/>
</div>
<div id="ct-backlayer" class="fixed" style="display:none; top:120px">
</div>
<div class="devicemenu" id="deviceMenu" style="display: block; position: absolute; display: none">
    <ul>
        <lh>
        <div id="devicemenuheader">
            <span id="hostName"></span>
            <br/>
            <span id="ipaddress-device-menu" class="translation Translations.general.label.ipaddress" ></span> : <span id="ip"></span>
        </div>
        </lh>
        <li><a id="accessscheduling" href="#"><span class="auth-required first active translation Translations.config.access.scheduling.label.menu"></span></a></li>
        <li><a id="devicescustomize" href="#"><span class="auth-required first active translation Translations.home.devicescustomize.label.title"></span></a></li>
    </ul>
</div>
<div class="devicemenu" id="catIqMenu" style="display: block; position: absolute; display: none">
    <ul>
        <lh>
        <div id="catIqdevicemenuheader">
            <span id="catIqName"></span>
            <br/>
            <span id="model" style="font-weight: normal"></span>
            <br/>
            <span id="lastupdate" style="font-weight: normal"></span>

        </div>
        </lh>
        <li><a id="catIqCustomize" href="#"><span class="auth-required first active translation Translations.home.devicescustomize.label.title"></span></a></li>
    </ul>
</div>
<div class="devicemenu" id="disconnectedDeviceMenu" style="display: block; position: absolute; display: none">
    <ul>
        <lh>
        <div id="disconnectedDevicemenuheader">
            <span id="dHostName"></span>
        </div>
        </lh>
        <li><a id="dAccessscheduling" href="#"><span class="auth-required first active translation Translations.config.access.scheduling.label.menu"></span></a></li>
        <li><a id="dDevicescustomize" href="#"><span class="auth-required first active translation Translations.home.devicescustomize.label.title"></span></a></li>
        <!--        <li><span id="deletedevicemenuitem" class="translation Translations.notconnecteddevices.label.deletedevice"></span></li> -->
    </ul>
</div>
<div class="devicemenu" id="usbDeviceMenu" style="display: block; position: absolute; display: none">
    <ul>
        <lh>
        <div id="UdbDevicemenuheader">
        </div>
        </lh>
        <li><a id="usbBrowse" href="#" onclick="return false;"><span id="usbBrowse" class="first active translation Translations.general.btn.files"></span></a></li>
        <li><a id="usbEject" href="#" onclick="return false;"><span class="first active translation Translations.general.btn.eject"></span></a></li>
    </ul>
</div>
<div class="devicemenu" id="contextualMenu" style="display: block; position: absolute; display: none">
    <ul>
        <lh>
        <div id="open">
             Open
        </div>
        </lh>
        <li><a id="copy" href="#"><span class="auth-required first translation Translations.filesbrowser.label.copy"></span></a></li>
        <li><a id="paste" href="#"><span class="auth-required translation Translations.filesbrowser.label.paste" style="display: none"></span></a></li>
        <li><a id="rename" href="#"><span class="auth-required translation Translations.filesbrowser.label.rename"></span></a></li>
    </ul>
</div>
<!-- Scrollable document container -->
<div id="document-container">
    <div id="document-background-header">
        <div id="document-background-footer">
            <div id="document">
                <div id="header">
                    <a href="/" ><div id="header-logo-livebox">
                    </div></a>
                    <div id="header-controls-login">
                        <div id="authenticationerrors">
                            <span id="emptyauthfields" style="display: none" class="translation Translations.home.authentication.error.empty"></span>
                            <span id="emptyauthinvalid" style="display: none" class="translation Translations.home.authentication.error.invalid"></span>
                        </div>
                        <div id="header-controls-login-interactions" style=" vertical-align: top;">
                            <form name="Home/Accessibility"></form>
                            <form name="Login" id="Login">
                                <div id="login-inputs-div">
                                    <input name="username" type="hidden" id="Username"/>
                                    <input name="password" type="hidden" id="Password"/>
                                    <input type="text" style="width:100px;" id="PopupUsername" class="input-text input-text-gray" maxlength="32" value="" disabled="disabled"/>
                                    <input type="password" style="width:100px;" id="PopupPassword" class="input-text input-text-gray " value="" maxlength="32"/>
                                    <input type="submit" class="input-btn input-btn-orange translation Translations.general.btn.authenticate" value="" id="bt_authenticate"/>
                                </div>
                                <div id="logout-link-div" style="display: none;">
                                    <span id="logged_in_username"></span>: <a href="#" id="logout_link"><span class="translation Translations.general.label.logout"></span></a>
                                </div>
                            </form>
                            <form name="ForgottenPassword" id="ForgottenPassword">
                                <div id="forgotten-password-link-div"style="white-space:nowrap">
                                    <a href="#" id="header-controls-forgotten-password-link"><span  class="translation Translations.general.label.forgottenpassword"></span></a>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div id="header-controls">
                        <form name="Admin/UserInterface/Language" action="">
                            <div id="header-controls-languages">
                                <select id="Language-select" name="Language-select">
                                </select>
                            </div>
                        </form>
                        <div id="header-controls-accessibility-minus" class="header-controls-accessibility">
                            <a href="#" class="nologin "><img src="/images/fr/common/transparent.gif?v=bdbae052" class="png voice Voice.accessibility.fontsize.img.decrease" alt=""/></a>
                        </div>
                        <div id="header-controls-accessibility-plus" class="header-controls-accessibility">
                            <a href="#" class="nologin "><img src="/images/fr/common/transparent.gif?v=bdbae052" class="png voice Voice.accessibility.fontsize.img.increase" alt=""/></a>
                        </div>
                        <div id="header-controls-accessibility-contrast1" class="header-controls-accessibility">
                            <a href="#" class="nologin "><img src="/images/fr/common/transparent.gif?v=bdbae052" class="png voice Voice.accessibility.contrast.img.level1" alt=""/></a>
                        </div>
                        <div id="header-controls-accessibility-contrast2" class="header-controls-accessibility">
                            <a href="#" class="nologin "><img src="/images/fr/common/transparent.gif?v=bdbae052" class="png voice Voice.accessibility.contrast.img.level2" alt=""/></a>
                        </div>
                        <div id="header-controls-accessibility-contrast3" class="header-controls-accessibility">
                            <a href="#" class="nologin voice Voice.accessibility.contrast.link.level3"><img src="/images/fr/common/transparent.gif?v=bdbae052" class="png voice Voice.accessibility.contrast.img.level3" alt=""/></a>
                        </div>
                        <form name="Home/Information">
                        </form>
                        <form name="Home/RemoteBackup">
                        </form>
                    </div>
                    <div id="header-hmenu">
                        <ul class="hmenu">
                            <li onclick="return Sah.redirect('/');" id="hmenu-home" class="first active"><a href="/"><span class="first active translation Translations.general.label.vmenu.home.title"></span></a></li>
                            <li onclick="return Sah.redirect('/configWifi.html');" id="hmenu-wifi" class="normal auth-required"><a href="/configWifi.html" class="auth-required"><span class="translation Translations.general.label.vmenu.config.title"></span></a></li>
                            <li onclick="return Sah.redirect('/myFiles.html');" id="hmenu-myfiles" class="normal auth-required"><a href="/myFiles.html" class="auth-required"><span class="translation Translations.general.label.vmenu.files.title"></span></a></li>
                            <!--<li id="hmenu-myipphone" class="normal auth-required"><a href="/phonebook.html" onclick="return Sah.redirect('/phonebook.html');" class="auth-required"><span class="translation Translations.general.label.vmenu.ipphone.title"></span></a></li> -->
                            <li onclick="return Sah.redirect('/phoneRingTest.html');" id="hmenu-myipphone" class="normal auth-required"><a href="/phoneRingTest.html" class="auth-required"><span class="translation Translations.general.label.vmenu.ipphone.title"></span></a></li>
                            <li onclick="return Sah.redirect('/supportLedsStatus.html');" id="hmenu-support" class="normal auth-required"><a href="/supportLedsStatus.html" class="auth-required"><span class="translation Translations.general.label.vmenu.support.title"></span></a></li>
                            <li onclick="return Sah.redirect('/advConfigNetworkDhcp.html');" id="hmenu-advconfig" class="last gray auth-required"><a href="/advConfigNetworkDhcp.html" class="auth-required"><span class="translation Translations.general.label.vmenu.advconfig.title"></span></a></li>
                        </ul>
                    </div>
                </div>
                <div id="content">
                    
<div id="content-left">
	<ul id="content-left-vmenu" class="lbx2vmenu advConfigTabs">
		<li id="left-dhcp-link"  class="auth-required">
			<a href="/advConfigNetworkDhcp.html"><span class="translation Translations.general.label.vmenu.advconfig.network"></span></a>
		</li>
		<li id="left-firewall-link" class="auth-required">
			<a href="/advConfigFirewall.html"><span class="translation Translations.general.label.vmenu.advconfig.firewall"></span></a>
		</li>
		<div id="advConfigIPv6Div">
			<li id="advConfigIPv6" class="auth-required" style="display:none">
				<a href="/advConfigIPv6.html"><span id="advConfigIPv6Span" class="translation Translations.general.label.vmenu.advconfig.ipv6"></span></a>
			</li>
		</div>
		<li id="advConfigPorts" class="auth-required">
			<a href="/advConfigPorts.html"><span class="translation Translations.advconfig.ports.label.title"></span></a>
		</li>
		<!--	<li onclick="return Sah.redirect('/advConfigRouting.html');" class="auth-required">
				<span class="translation Translations.general.label.vmenu.advconfig.routing"></span>
			</li> -->
		<li class="lbx2menuseparator"></li>

		<li id="left-remote-link" class="auth-required">
			<a href="/supportRemoteAccess.html"><span class="translation Translations.support.remoteaccess.label.title"></span></a>
		</li>
		<li id="separator" class="lbx2menuseparator"></li>

		<li id="left-access-link" class="auth-required">
			<a href="/advConfigAccessType.html"><span class="translation Translations.advconfig.accesstype.label.title"></span></a>
		</li>
		<li id="left-admin-link" class="auth-required">
			<a href="/advConfigAdmin.html"><span class="translation Translations.advconfig.admin.label.title"></span></a>
		</li>
		<li id="left-fxo-link" style="display:none">
			<a href="/advConfigFxo.html" id="vmenu-phoneline">
				<span class="translation Translations.general.label.vmenu.advconfig.phonelineconfig"></span>
			</a>
		</li>


	</ul>
	<script type="text/javascript">
		$("left-dhcp-link").observe("click",function(e){Sah.redirect('/advConfigNetworkDhcp.html')});
		$("left-firewall-link").observe("click",function(e){Sah.redirect('/advConfigFirewall.html')});
		$("advConfigPorts").observe("click",function(e){Sah.redirect('/advConfigPorts.html')});
		$("advConfigIPv6").observe("click",function(e){Sah.redirect('/advConfigIPv6.html')});
		$("left-remote-link").observe("click",function(e){Sah.redirect('/supportRemoteAccess.html')});
		$("left-access-link").observe("click",function(e){Sah.redirect('/advConfigAccessType.html')});
		$("left-admin-link").observe("click",function(e){Sah.redirect('/advConfigAdmin.html')});
		
		new Ajax.Request("/sysbus/NMC:getWANStatus", {
			method: "post",
			contentType:"application/x-sah-ws-4-call+json",
			requestHeaders: {
				"X-Context":Sah.Bus.contextID,
				"X-Sah-Request-Type": "idle"
			},
			onSuccess: this.stateReceived.bind(this),
			onFailure: function(){}
		});
		function stateReceived(response) {
			var state ; 
			if (state=response.responseText) {
			     response=JSON.parse(state);
				
			     if ((response.data.LinkType.toLowerCase().indexOf("dsl") >= 0 || response.data.LinkType.toLowerCase().indexOf("ethernet" >= 0)) && (response.data.Protocol.toLowerCase().indexOf("ppp") >= 0)) {
					$("advConfigIPv6Div").hide();
					$("advConfigIPv6").hide();
					$("advConfigIPv6Span").hide();

			     } else{    
			     		$("advConfigIPv6Div").show();
					$("advConfigIPv6").show();
					$("advConfigIPv6Span").show();
					
			     }
			}
		}
		
	</script>
</div>


<div id="content-center">
	<script type="text/javascript">
		
		// Vertical menu
		var oVMenuItem = $CYT('#content-left-vmenu span.Translations.general.label.vmenu.advconfig.firewall')[0];
		ctl.style.klass.Add(oVMenuItem.parentNode.parentNode,"current");
			
		// Horizontal menu
		ctl.style.klass.Remove($CYT('#header-hmenu li.active'),"active");
		ctl.style.klass.Add($CYT('#hmenu-advconfig'),"active");
	</script>
	<a href="/advConfigFirewall.html"><span class="translation Translations.general.label.vmenu.advconfig.title"></span></a> >  <span id="deviceNameTop"></span> - <span class="translation Translations.general.label.vmenu.advconfig.firewall"></span>
	<div class="hr hr-orange"></div>
	<br/>
	<h1><span class="translation Translations.advconfig.firewalladv.label.title"></span></h1>
	<div class="hr">
	</div>
	<h2><span class="translation Translations.advconfig.firewalladv.label.subtitle"></span></h2>
	<br/>
	<span class="translation Translations.advconfig.firewalladv.label.ping"></span><br/>
	<br/>
	<form name="Security/Ping">
		<div class="grayzone" style="padding: 5px;">
			<h6>
				<input type="checkbox" style="padding:0px 10px 0px 20px;" name="SelectedLevel.RespondToPing" class="voice Voice.advconfig.firewalladv.label.pinganswer"/>
				<span class="translation Translations.advconfig.firewalladv.label.pinganswer"></span></h6>
		</div>
		<br/>
		<div style="text-align:right; height:35px;">
			<input type="button" id="bt_cancel" value="annuler" class="input-btn input-btn-gray translation Translations.general.btn.cancel SecurityPingCancel" />
			<input type="button" id="bt_save" value="enregistrer" class="input-btn input-btn-orange translation Translations.general.btn.save SecurityPingSave"/>
		</div>
		<br/>
	</form>
	<form name="Security/Rule">
		<div class="hr hr-orange">
		</div>
		<h3><span class="translation Translations.advconfig.firewalladv.label.personalrules"></span></h3>
		<div id="config.security.firewalladverror" style="display:none;">
			<br/>
			<img src="/images/fr/common/transparent.gif?v=bdbae052" style="float:left; width:40px; height:30px; background-image:url('/images/fr/icons/icons-error.gif?v=bdbae052'); margin-right:10px;" class="png voice Voice.general.icon.error" alt=""/>
			<div id="firewalladv_error" style="padding-top:8px;">
			</div>
		</div>
		<br/>
		<table class="array">
			<thead>
				<tr>
					<th colspan="10" class="first last" scope="colgroup" ><span class="translation Translations.advconfig.firewalladv.label.staticip"></span></th>
				</tr>
				<tr class="subheader">
					<th scope="col" class="first" style="width:70px;"><span class="translation Translations.advconfig.firewalladv.label.application"></span></th>
					<th scope="col" style="width:50px;"><span class="translation Translations.advconfig.firewalladv.label.protocol"></span></th>
					<th scope="col" style="width:75px;"><span class="translation Translations.advconfig.firewalladv.label.source"></span></th>
					<th scope="col" style="width:75px;"><span class="translation Translations.advconfig.firewalladv.label.mask"></span></th>
					<th scope="col" style="width:50px;"><span class="translation Translations.advconfig.firewalladv.label.sourceport"></span></th>
					<th scope="col" style="width:75px;"><span class="translation Translations.advconfig.firewalladv.label.destination"></span></th>
					<th scope="col" style="width:75px;"><span class="translation Translations.advconfig.firewalladv.label.mask"></span></th>
					<th scope="col" style="width:50px;"><span class="translation Translations.advconfig.firewalladv.label.destinationport"></span></th>
					<th scope="col" style="width:50px;"><span class="translation Translations.advconfig.firewalladv.label.action"></span></th>
					<th scope="col" class="last" style="width:100px;"><span></span></th>
				</tr>
			</thead>
			<tbody>

				<tr>
					<td class="first">
						<select style="width:70px;" name="Rule.Description">
						</select>
						<div id="rule_custom_description" style="float:left; width:84px; display: none;">
							<!-- 
							WebUI workaround. As middleware systematically set Enable parameter to 1 on reboot, rules are removed from Data Model by WebUI and Enable parameter is no more used.
							As a consequence, selection box is no more used on WebUI. Width of "Rule.CustomDescription" is set to 60px instead of 40px and display:none is set on image
							--> 
							<input name="Rule.CustomDescription" type="text" style="width:60px; float:left;" class="input-text input-text-gray"/><a href="#"><img src="/images/fr/common/transparent.gif?v=bdbae052" class="input-button-small-back voice Voice.general.icon.refrech" ></a>
						</div>
					</td>
					<td><select id="rule-protocol-select" style="width:50px;" name="Rule.Protocol" class="voice Voice.advconfig.firewalladv.label.bothprotocol">
							<option value="6">TCP</option>
							<option value="17">UDP</option>
							<option class="translation Translations.advconfig.firewalladv.label.bothprotocol" value="both">both</option>
						</select></td>
					<td><input id="Rule.SourceIP" name="Rule.SourceIP" type="text" style="width:70px" class="input-text input-text-gray voice Voice.advconfig.firewalladv.label.souceip"/></td>
					<td><input id="Rule.SourceIPMask" name="Rule.SourceIPMask" type="text" style="width:70px" class="input-text input-text-gray voice Voice.advconfig.firewalladv.label.souceipmask"/></td>
					<td><input id="Rule.SourcePort" name="Rule.SourcePort" type="text" style="width:40px" class="input-text input-text-gray voice Voice.advconfig.firewalladv.label.souceipport"/></td>
					<td><input id="Rule.DestinationIP" name="Rule.DestinationIP" type="text" style="width:70px" class="input-text input-text-gray voice Voice.advconfig.firewalladv.label.destinationip"/></td>
					<td><input id="Rule.DestinationIPMask" name="Rule.DestinationIPMask" type="text" style="width:70px" class="input-text input-text-gray voice Voice.advconfig.firewalladv.label.destinationipmask"/></td>
					<td><input id="Rule.DestinationPort" name="Rule.DestinationPort" type="text" style="width:40px" class="input-text input-text-gray voice Voice.advconfig.firewalladv.label.destinationipport"/></td>
					<td><select id="Rule.Target" name="Rule.Target" style="width:50px;">
							<option class="translation Translations.advconfig.firewalladv.label.accept" value="Accept"></option>
							<option class="translation Translations.advconfig.firewalladv.label.drop" value="Drop"></option>
						</select></td>
					<td class="last"><input type="button" id="bt_save2" value="enregistrer" class="input-btn input-btn-orange-small translation Translations.general.btn.save SecurityRuleSave"/></td>
				</tr>
				<tr>
					<td colspan="10" style="background-color:white; padding:0px; height:5px; line-height:5px;"></td>
				</tr>
				<tr id="Rule" class="template" style="display: none;">
					<td scope="row" class="first sah:Id"></td>
					<td class="sah:ProtocolText protocol"></td>
					<td id="src" class="sah:SourceIP SourceIP"></td>
					<td class="sah:SourceIPMask"></td>
					<td class="sah:SourcePort SourcePort"></td>
					<td id="dest" class="sah:DestinationIP DestinationIP"></td>
					<td class="sah:DestinationIPMask"></td>
					<td class="sah:DestinationPort DestinationPort"></td>
					<td class="sah:Target target" ></td>
					<td class="last RuleDelete">
						<input type="button" name="nat.delete" class="btn-delete input-btn input-btn-orange-small translation Translations.general.label.destroy" value=""> 
					</td>
				</tr>
			</tbody>
		</table>
		<br/>
	</form>
</div>
<div id="content-right"></div>

                </div>
                <div id="footer">
                    <div id="footer-logo-ft">
                    </div>
                    <div id="footer-menu">
                        <a href="/legal.html" onclick="return Sah.redirect('/legal.html');"><span class="translation Translations.legal.label.title"></span></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
        EXPIRY_DATE_ID=-1;
        function bindReady(handler){
            var called = false
            function ready() {
                if (called) return
                called = true
                handler()
            }
            if ( document.addEventListener ) { // native event
                document.addEventListener( "DOMContentLoaded", ready, false )
            } else if ( document.attachEvent ) {  // IE
                try {
                    var isFrame = window.frameElement != null
                } catch(e) {}
                // IE, the document is not inside a frame
                if ( document.documentElement.doScroll && !isFrame ) {
                    function tryScroll(){
                        if (called) return
                        try {
                            document.documentElement.doScroll("left")
                            ready()
                        } catch(e) {
                            setTimeout(tryScroll, 10)
                        }
                    }
                    tryScroll()
                }
                // IE, the document is inside a frame
                document.attachEvent("onreadystatechange", function(){
                    if ( document.readyState === "complete" ) {
                        ready()
                    }
                })
            }
            // Old browsers
            if (window.addEventListener)
                window.addEventListener('load', ready, false)
            else if (window.attachEvent)
                window.attachEvent('onload', ready)
            else {
                var fn = window.onload // very old browser, copy old onload
                window.onload = function() { // replace by new onload and call the old one
                    fn && fn()
                    ready()
                }
            }
        }
        bindReady(function() {
            var login = Cookie.get('login');
            if (login != null && login.length > 24){
                Cookie.unset('sessid');
                Cookie.unset('expirydate');
                Cookie.unset('login');
                Cookie.unset('context');

                new Ajax.Request("/logout", {
                    onComplete: function(){Sah.redirect('/');},
                    method: "get"
                });
            }

            if (Cookie.get('expirydate') !== undefined && Cookie.get('expirydate') !== null){

                var expiryValue = Cookie.get('expirydate'),
                    expiryDate = new Date(expiryValue);

                if ( Object.prototype.toString.call(expiryDate) !== '[object Date]' || !isFinite(expiryDate) )
                    expiryDate = new Date(parseInt(expiryValue));

                var currentDate = new Date(),
                    remainingTime = expiryDate.getTime() - currentDate.getTime();

                if(remainingTime < 0 ){
                    Cookie.unset('expirydate');
                } else {
                    clearTimeout(EXPIRY_DATE_ID);
                    EXPIRY_DATE_ID=setTimeout(function(){
                        Cookie.unset('sessid');
                        Cookie.unset('expirydate');
                        Cookie.unset('login');
                        Cookie.unset('context');

                        new Ajax.Request("/logout", {
                            onComplete: function(){Sah.redirect('/');},
                            method: "get"
                        });
                    }, remainingTime);
                }

            }

            if ( appConfig === 'fr' ) {
                $('hmenu-myfiles').remove();
                if ( $('advConfigPorts') !== null ) {
                    $('advConfigPorts').remove();
                }
                if ( $('left-fxo-link') !== null ) {
                    $('left-fxo-link').remove();
                }
            }
            if (config.BUILD_PROJECT.indexOf("2.8") < 0) {
                if ( $('left-fxo-link') !== null ) {
                    $("left-fxo-link").show();
                }
            }
            $('Login').observe("submit",function(e){
                Event.stop(e);
                $('Username').setValue($F('PopupUsername'));
                $('Password').setValue($F('PopupPassword'));
                return true;
            }.bind(this));

            $("popup-close-btn").observe("click",function(e){
                ctl.popup.Close();
                return false;
            });

            $$('.hmenu li a').each(function (el) {
                Event.observe(el, 'mouseup', function(event) {
                    Sah.redirect(el.href);
                });
            });
        });
            
            
        Event.observe(document, "click", function (event) {
             var sessionDuration = (config.SESSION_DURATION ? parseInt(config.SESSION_DURATION) : 600000);
                
             if (sessionDuration !== 0){                
             var d = new Date();
             d.setTime(d.getTime() + (sessionDuration * 1000));
             Cookie.set('expirydate', d);
                    
            }

            var login = Cookie.get('login');
                if (login != null && login.length > 24){
                    Cookie.unset('sessid');
                    Cookie.unset('expirydate');
                    Cookie.unset('login');
                    Cookie.unset('context');

                    new Ajax.Request("/logout", {
                        onComplete: function(){Sah.redirect('/');},
                        method: "get"
                    });
                }
            
                if (Cookie.get('expirydate') !== undefined && Cookie.get('expirydate') !== null){
                
                    var expiryValue = Cookie.get('expirydate'), 
                        expiryDate = new Date(expiryValue);
                                    
                    if ( Object.prototype.toString.call(expiryDate) !== '[object Date]' || !isFinite(expiryDate) )
                        expiryDate = new Date(parseInt(expiryValue));           
                    
                    var currentDate = new Date(),
                        remainingTime = expiryDate.getTime() - currentDate.getTime();

                    if(remainingTime < 0 ){
                        Cookie.unset('expirydate');
                    } else {
                        clearTimeout(EXPIRY_DATE_ID);
                        EXPIRY_DATE_ID=setTimeout(function(){
                            Cookie.unset('sessid');
                            Cookie.unset('expirydate');
                            Cookie.unset('login');
                            Cookie.unset('context');

                            new Ajax.Request("/logout", {
                                onComplete: function(){Sah.redirect('/');},
                                method: "get"
                            });
                        }, remainingTime);
                    }

                }
        });
        
</script>
</body>
</html>
